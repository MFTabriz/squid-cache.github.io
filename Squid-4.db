<?xml version="1.0" encoding="utf-8"?><!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>Squid-4</title><revhistory><revision><revnumber>26</revnumber><date>2021-08-04 07:46:18</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>25</revnumber><date>2018-08-16 10:37:00</date><authorinitials>AmosJeffries</authorinitials><revremark>add default config file example</revremark></revision><revision><revnumber>24</revnumber><date>2018-07-02 05:41:39</date><authorinitials>AmosJeffries</authorinitials><revremark>update policy on additions</revremark></revision><revision><revnumber>23</revnumber><date>2018-07-02 05:38:09</date><authorinitials>AmosJeffries</authorinitials><revremark>4.1 stable released</revremark></revision><revision><revnumber>22</revnumber><date>2018-02-27 03:16:55</date><authorinitials>AmosJeffries</authorinitials><revremark>even better bug istign accuracy for major bugs</revremark></revision><revision><revnumber>21</revnumber><date>2018-02-27 03:14:31</date><authorinitials>AmosJeffries</authorinitials><revremark>updates to features and bug listings since last review</revremark></revision><revision><revnumber>20</revnumber><date>2018-01-23 06:11:00</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>19</revnumber><date>2016-11-15 07:04:07</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>18</revnumber><date>2016-01-05 06:10:40</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>17</revnumber><date>2015-10-14 06:18:16</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>16</revnumber><date>2015-10-14 05:51:51</date><authorinitials>AmosJeffries</authorinitials><revremark>update for first beta release</revremark></revision><revision><revnumber>15</revnumber><date>2015-09-21 02:55:35</date><authorinitials>AmosJeffries</authorinitials><revremark>add reference to list of bugs specifically know to be new in this version, remove incorrect reference to blockers list</revremark></revision><revision><revnumber>14</revnumber><date>2015-09-21 02:45:36</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>13</revnumber><date>2015-08-26 13:51:20</date><authorinitials>AmosJeffries</authorinitials><revremark>ICC claims C+=11 compliance but does not include support for several key features</revremark></revision><revision><revnumber>12</revnumber><date>2015-03-16 10:56:52</date><authorinitials>AmosJeffries</authorinitials><revremark>some OS releases of GCC 4.8 and clang 3.4 dont build their own STL objects properly</revremark></revision><revision><revnumber>11</revnumber><date>2015-03-13 13:07:57</date><authorinitials>AmosJeffries</authorinitials><revremark>version change</revremark></revision><revision><revnumber>10</revnumber><date>2015-03-13 13:06:56</date><authorinitials>AmosJeffries</authorinitials><revremark>text updates for version 4</revremark></revision><revision><revnumber>9</revnumber><date>2015-03-08 05:03:33</date><authorinitials>AmosJeffries</authorinitials><revremark>update list of features to current</revremark></revision><revision><revnumber>8</revnumber><date>2015-02-02 15:38:57</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>7</revnumber><date>2015-02-02 14:55:33</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>6</revnumber><date>2015-02-02 14:52:39</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>5</revnumber><date>2015-01-26 12:00:13</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>4</revnumber><date>2015-01-17 06:14:52</date><authorinitials>AmosJeffries</authorinitials><revremark>Update change list, including minor and developer focused additions</revremark></revision><revision><revnumber>3</revnumber><date>2014-12-06 11:33:20</date><authorinitials>AmosJeffries</authorinitials><revremark>document larger UI feature additions so far</revremark></revision><revision><revnumber>2</revnumber><date>2014-10-09 08:04:17</date><authorinitials>AmosJeffries</authorinitials><revremark>3.6 entering development as 3.HEAD</revremark></revision><revision><revnumber>1</revnumber><date>2014-05-09 06:57:28</date><authorinitials>AmosJeffries</authorinitials><revremark>create early to get the C++11 announcement on roadmap</revremark></revision></revhistory></articleinfo><section><title>Squid 4</title><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> Aug 2021 </para></entry><entry colsep="1" rowsep="1"><para> Squid-4 series became <emphasis role="strong">DEPRECATED</emphasis> with the release of  <ulink url="https://wiki.squid-cache.org/Squid-4/Squid-5#">Squid-5</ulink> series </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> Jul 2018 </para></entry><entry colsep="1" rowsep="1"><para> Released for production use. </para></entry></row></tbody></tgroup></informaltable><para>The features have been set and large code changes are reserved for later versions. </para><itemizedlist><listitem override="none"><para>Additions are limited to: </para></listitem><listitem><para>Security fixes </para></listitem><listitem><para>Stability fixes </para></listitem><listitem><para>Bug fixes </para></listitem><listitem><para>Documentation updates </para></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-error.png" width="16"/></imageobject><textobject><phrase>{X}</phrase></textobject></inlinemediaobject> This series of Squid requires a C++11 capable compiler. The currently known compilers which meet this criteria and build Squid-4 reliably are GCC 4.9+ and Clang 3.5+ </para></listitem></itemizedlist><para>Basic new features in version 4: </para><itemizedlist><listitem><para><emphasis role="strong">Major UI changes:</emphasis> </para><itemizedlist><listitem><para>RFC <ulink url="https://tools.ietf.org/rfc/rfc6176#">6176</ulink> compliance (SSLv2 support removal) </para></listitem><listitem><para>Secure ICAP service connections </para></listitem><listitem><para>Add url_lfs_rewrite: a URL-rewriter based on local file existence </para></listitem><listitem><para><ulink url="http://www.squid-cache.org/Doc/config/on_unsupported_protocol#">on_unsupported_protocol</ulink> directive to allow Non-HTTP bypass </para></listitem><listitem><para>Removal of <ulink url="http://www.squid-cache.org/Doc/config/refresh_pattern#">refresh_pattern</ulink> ignore-auth and ignore-must-revalidate options </para></listitem><listitem><para>Remove <ulink url="http://www.squid-cache.org/Doc/config/cache_peer_domain#">cache_peer_domain</ulink> directive </para></listitem><listitem><para>basic_msnt_multi_domain_auth: Superceeded by basic_smb_lm_auth </para></listitem><listitem><para>Update <ulink url="http://www.squid-cache.org/Doc/config/external_acl_type#">external_acl_type</ulink> directive to take logformat codes in its format parameter </para></listitem><listitem><para>Removal of ESI custom parser </para></listitem><listitem><para>Experimental GnuTLS support for some TLS features </para></listitem></itemizedlist></listitem><listitem><para><emphasis role="strong">Minor UI changes:</emphasis> </para><itemizedlist><listitem><para>Sub-millisecond transaction logging </para></listitem><listitem><para>ext_kerberos_ldap_group_acl -n option to disable automated SASL/GSSAPI </para></listitem><listitem><para>negotiate_kerberos_auth outputs group= kv-pair for use in note ACL </para></listitem><listitem><para>security_file_certgen helper supports memory-only mode </para></listitem><listitem><para>Adaptation support for Expect:100-continue in HTTP messages </para></listitem><listitem><para>Add <ulink url="http://www.squid-cache.org/Doc/config/url_rewrite_timeout#">url_rewrite_timeout</ulink> directive </para></listitem><listitem><para>Update localnet ACL default definition for RFC <ulink url="https://tools.ietf.org/rfc/rfc6890#">6890</ulink> compliance </para></listitem><listitem><para>Persistent connection timeouts <ulink url="http://www.squid-cache.org/Doc/config/request_start_timeout#">request_start_timeout</ulink> and <ulink url="http://www.squid-cache.org/Doc/config/pconn_lifetime#">pconn_lifetime</ulink> </para></listitem><listitem><para>Per-rule <ulink url="http://www.squid-cache.org/Doc/config/refresh_pattern#">refresh_pattern</ulink> matching statistics in cachemgr report </para></listitem><listitem><para>Configurable helper queue size, with consistent defaults and better overflow handling </para></listitem></itemizedlist></listitem><listitem><para><emphasis role="strong">Developer Interest changes:</emphasis> </para><itemizedlist><listitem><para>C++11 </para></listitem><listitem><para>New helper concurrency channel-ID assignment algorithm </para></listitem><listitem><para>Simplify MEMPROXY_CLASS_* macros </para></listitem><listitem><para>Simplify CBDATA API and rename CBDATA_CLASS </para></listitem><listitem><para>HTTP Parser structural redesign </para></listitem><listitem><para>Base64 crypto API replacement </para></listitem><listitem><para>Enable long (--foo) command line parameters on squid binary </para></listitem><listitem><para>Implemented selective debugs() output for unit tests </para></listitem><listitem><para>Improved SMP support </para></listitem></itemizedlist></listitem></itemizedlist><para>The intention with this series is to improve performance using C++11 features. Some remaining <ulink url="https://wiki.squid-cache.org/Squid-4/Squid-2.7#">Squid-2.7</ulink> missing features are listed as regressions in <ulink url="http://www.squid-cache.org/Versions/v4/RELEASENOTES.html#ss5.1"/> </para><para>Packages of what will become Squid-4 source code are available at <ulink url="http://www.squid-cache.org/Versions/v4/"/> </para><section><title>Security Advisories</title><para>See our <ulink url="http://www.squid-cache.org/Advisories/">Advisories</ulink> list. </para></section><section><title>Open Bugs</title><itemizedlist><listitem override="none"><para><ulink url="http://bugs.squid-cache.org/buglist.cgi?bug_id_type=anyexact&amp;bug_severity=blocker&amp;bug_severity=critical&amp;bug_severity=major&amp;bug_status=UNCONFIRMED&amp;bug_status=NEW&amp;bug_status=ASSIGNED&amp;bug_status=REOPENED&amp;chfieldto=Now&amp;product=Squid&amp;query_format=advanced&amp;columnlist=bug_severity%2Cversion%2Cop_sys%2Cshort_desc&amp;order=version%20DESC%2Cbug_severity%2Cbug_id&amp;o2=equals&amp;v2=unspecified&amp;f1=version&amp;o1=lessthaneq&amp;v1=4">Major or higher bugs currently affecting this version</ulink>. </para><itemizedlist><listitem><para>Bugs against any older version can be closed if found fixed in 4.x </para></listitem><listitem><para>Bugs inherited from older versions are not necessarily blockers on stable. </para></listitem></itemizedlist></listitem></itemizedlist><itemizedlist><listitem override="none"><para><ulink url="http://bugs.squid-cache.org/buglist.cgi?query_format=advanced&amp;product=Squid&amp;version=4&amp;bug_status=UNCONFIRMED&amp;bug_status=NEW&amp;bug_status=ASSIGNED&amp;bug_status=REOPENED&amp;bug_severity=blocker&amp;bug_severity=critical&amp;bug_severity=major&amp;bug_severity=normal&amp;bug_severity=minor&amp;emailtype1=substring&amp;email1=&amp;emailtype2=substring&amp;email2=&amp;bugidtype=include&amp;columnlist=bug_severity%2Cversion%2Cop_sys%2Cshort_desc&amp;list_id=917&amp;order=version DESC%2Cbug_severity%2Cbug_id">Bugs new in this version</ulink> </para></listitem></itemizedlist></section><section><title>Squid-4 default config</title><screen><![CDATA[http_port 3128
]]><![CDATA[
# Example rule allowing access from your local networks.
# Adapt to list your (internal) IP networks from where browsing
# should be allowed
acl localnet src 0.0.0.1-0.255.255.255  # RFC 1122 "this" network (LAN)
acl localnet src 10.0.0.0/8             # RFC 1918 local private network (LAN)
acl localnet src 100.64.0.0/10          # RFC 6598 shared address space (CGN)
acl localnet src 169.254.0.0/16         # RFC 3927 link-local (directly plugged) machines
acl localnet src 172.16.0.0/12          # RFC 1918 local private network (LAN)
acl localnet src 192.168.0.0/16         # RFC 1918 local private network (LAN)
acl localnet src fc00::/7               # RFC 4193 local private network range
acl localnet src fe80::/10              # RFC 4291 link-local (directly plugged) machines
]]><![CDATA[
acl SSL_ports port 443
acl Safe_ports port 80          # http
acl Safe_ports port 21          # ftp
acl Safe_ports port 443         # https
acl Safe_ports port 70          # gopher
acl Safe_ports port 210         # wais
acl Safe_ports port 1025-65535  # unregistered ports
acl Safe_ports port 280         # http-mgmt
acl Safe_ports port 488         # gss-http
acl Safe_ports port 591         # filemaker
acl Safe_ports port 777         # multiling http
]]><![CDATA[
http_access deny !Safe_ports
http_access deny CONNECT !SSL_ports
http_access allow localhost manager
http_access deny manager
]]><![CDATA[
#
# INSERT YOUR OWN RULE(S) HERE TO ALLOW ACCESS FROM YOUR CLIENTS
#
]]><![CDATA[
http_access allow localnet
http_access allow localhost
http_access deny all
]]><![CDATA[
coredump_dir /squid/var/cache/squid
]]><![CDATA[
refresh_pattern ^ftp:           1440    20%     10080
refresh_pattern ^gopher:        1440    0%      1440
refresh_pattern -i (/cgi-bin/|\?) 0     0%      0
refresh_pattern .               0       20%     4320]]></screen></section></section></article>