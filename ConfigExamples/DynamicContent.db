<?xml version="1.0" encoding="utf-8"?><!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>ConfigExamples/DynamicContent</title><revhistory><revision><revnumber>12</revnumber><date>2021-07-03 11:26:53</date><authorinitials>FrancescoChemolli</authorinitials></revision><revision><revnumber>11</revnumber><date>2010-07-29 01:32:10</date><authorinitials>AmosJeffries</authorinitials><revremark>Note that cach deny QUERY is obsolete now.</revremark></revision><revision><revnumber>10</revnumber><date>2009-09-22 03:29:34</date><authorinitials>AmosJeffries</authorinitials><revremark>remove the non-working youtube demo in favor of a real explanation.</revremark></revision><revision><revnumber>9</revnumber><date>2009-07-26 07:14:35</date><authorinitials>AmosJeffries</authorinitials><revremark>we now dont recommend cache deny QUERY</revremark></revision><revision><revnumber>8</revnumber><date>2009-01-14 02:50:25</date><authorinitials>AmosJeffries</authorinitials><revremark>missing case-insensitive on demo.</revremark></revision><revision><revnumber>7</revnumber><date>2008-05-18 19:39:01</date><authorinitials>localhost</authorinitials><revremark>converted to 1.6 markup</revremark></revision><revision><revnumber>6</revnumber><date>2008-03-01 09:08:27</date><authorinitials>AmosJeffries</authorinitials><revremark>Update to new /cgi-bin/ regex pattern</revremark></revision><revision><revnumber>5</revnumber><date>2008-02-04 10:16:57</date><authorinitials>AmosJeffries</authorinitials></revision></revhistory></articleinfo><section><title>Caching Dynamic Content</title><para><emphasis role="strong">Warning</emphasis>: Any example presented here is provided &quot;as-is&quot; with no support or guarantee of suitability. If you have any further questions about these examples please email the squid-users mailing list. </para><section><title>Outline</title><para>The obsolete default configuration of squid prevents the caching of dynamic content (pages with ? in the URI), like so: </para><screen><![CDATA[hierarchy_stoplist cgi-bin ?
acl QUERY urlpath_regex cgi-bin \?
cache deny QUERY ]]></screen><para><emphasis role="strong">NOTE:</emphasis> That policy setting was created at a time when dynamic pages rarely contained proper Cache-Controls, that has now changed. From the release of Squid 2.7 and 3.1 the squid developers are advocating a change to this caching policy. These changes will also work in 3.0 and 2.6 releases despite not being officially changed for their squid.conf.default. </para><para>The changed policy is to remove the QUERY ACL and paired cache line. To be replaced by the refresh_patterns below: </para><screen><![CDATA[refresh_pattern -i (/cgi-bin/|\?) 0 0% 0
refresh_pattern .            0 20% 4320]]></screen></section><section><title>Additional</title><para>Some websites use query strings to obfuscate the file locations and increase their traffic loading. </para><para>The popular website youtube.com is one example which is dynamic, using query strings (?) to obfuscate the video locations but despite that has large flash video files and images in relatively static locations. </para><para>There are other specific needs detailed in <ulink url="https://wiki.squid-cache.org/ConfigExamples/DynamicContent/ConfigExamples/DynamicContent/YouTube#">ConfigExamples/DynamicContent/YouTube</ulink>. </para><para>The same mechanisms may be employed for other less popular sites as long as the site behavior and  obfuscation pattern is understood. </para><!--rule (<hr>) is not applicable to DocBook--><para> <ulink url="https://wiki.squid-cache.org/ConfigExamples/DynamicContent/CategoryConfigExample#">CategoryConfigExample</ulink> </para></section></section></article>