<?xml version="1.0" encoding="utf-8"?><!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>KnowledgeBase/ProxyPacSlow</title><revhistory><revision><revnumber>5</revnumber><date>2008-10-15 23:28:06</date><authorinitials>AmosJeffries</authorinitials><revremark>typo.</revremark></revision><revision><revnumber>4</revnumber><date>2008-05-18 19:38:56</date><authorinitials>localhost</authorinitials><revremark>converted to 1.6 markup</revremark></revision><revision><revnumber>3</revnumber><date>2007-03-10 09:53:20</date><authorinitials>kinkie</authorinitials><revremark>adjusted formatting to fit index-by-title</revremark></revision><revision><revnumber>2</revnumber><date>2007-03-10 09:02:39</date><authorinitials>kinkie</authorinitials><revremark>Despammed mail links, markup fixes</revremark></revision><revision><revnumber>1</revnumber><date>2007-03-09 18:10:37</date><authorinitials>AdrianChadd</authorinitials></revision></revhistory></articleinfo><section><title>Browser speed/lockup issues when using a proxy.pac auto configuration file</title><para><emphasis role="strong">Synopsis</emphasis> </para><para>A &quot;proxy.pac&quot; auto configuration file is frequently used to configure web browsers to use a web proxy under certain conditions. Various issues can arise which can result in the web browser appearing slow or unresponsive when attempting to resolve unknown domain names which seems to only occur whilst using the auto configuration file. </para><para><emphasis role="strong">Symptoms</emphasis> </para><itemizedlist><listitem><para>accessing normal sites is fast; accessing an unknown site causes the browser to lockup for longer than a few seconds; </para></listitem><listitem><para>removing the proxy auto configuration file from the Browser configuration stops the problem; or </para></listitem><listitem><para>configuring the proxy directly stops the problem </para></listitem></itemizedlist><para><emphasis role="strong">Explanation</emphasis> </para><para>A variety of javascript files are available for use in the proxy.pac file. One frequently used function is <code>isInNet()</code> which takes a hostname, IP, netmask and returns true if the host IP is in the given network/netmask range. </para><para>This requires the browser to perform a DNS lookup to map the given host to an IP address before it can attempt the match. </para><para>Some browsers will do a seperate DNS lookup for each <code>isInNet()</code> function call, resulting in a very long delay before finally completing the proxy lookup. This can result in slow or non-functional web browsing. <emphasis role="strong">Workaround</emphasis> </para><para>A javascript function is available to check whether the given host is resolvable. For example: </para><screen><![CDATA[if (! isResolvable(host)) {
    return "PROXY proxy.example.com:3128";
}]]></screen><para>will force non-resolvable names to be forwarded to the proxy immediately. </para><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="15" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/alert.png" width="15"/></imageobject><textobject><phrase>/!\</phrase></textobject></inlinemediaobject> This should be included before any javascript functions which require a DNS lookup to be performed, such as <code>isInNet()</code>. </para></listitem></itemizedlist><para><emphasis role="strong">Thanks</emphasis> </para><para>Thanks to Brian Riffle <code>&lt;riffle AT klamathcc DOT edu&gt;</code> for reporting the issue and successfully applying the suggested fix and David Gameau <code>&lt;David.Gameau AT unisa DOT edu DOT au&gt;</code> for identifying the problem and suggesting the workaround. </para><!--rule (<hr>) is not applicable to DocBook--><para> <ulink url="https://wiki.squid-cache.org/KnowledgeBase/ProxyPacSlow/CategoryKnowledgeBase#">CategoryKnowledgeBase</ulink> </para></section></article>