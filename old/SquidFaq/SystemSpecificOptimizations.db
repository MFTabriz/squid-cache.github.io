<?xml version="1.0" encoding="utf-8"?><!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>SquidFaq/SystemSpecificOptimizations</title><revhistory><revision><revnumber>3</revnumber><date>2008-05-18 19:38:58</date><authorinitials>localhost</authorinitials><revremark>converted to 1.6 markup</revremark></revision><revision><revnumber>2</revnumber><date>2007-04-19 16:21:08</date><authorinitials>kinkie</authorinitials><revremark>markup fix</revremark></revision><revision><revnumber>1</revnumber><date>2007-04-19 16:19:58</date><authorinitials>kinkie</authorinitials></revision></revhistory></articleinfo><section><title>General advice</title><para>The settings detailed in this FAQ chapter are suggestion for operating-system-specific settings which <emphasis role="strong">may</emphasis> help when running busy caches. It is recommended to check that the settings have the desired effect by using the <ulink url="https://wiki.squid-cache.org/SquidFaq/SystemSpecificOptimizations/SquidFaq/CacheManager#">Cache Manager</ulink>. </para></section><section><title>FreeBSD</title><section><title>Filedescriptors</title><para>For busy caches, it makes sense to increase the number of system-wide available filedescriptors, by setting in: in <code>/etc/sysctl.conf</code> </para><screen><![CDATA[kern.maxfilesperproc=8192]]></screen></section><section><title>Diskd</title><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> <inlinemediaobject><imageobject><imagedata depth="15" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/alert.png" width="15"/></imageobject><textobject><phrase>/!\</phrase></textobject></inlinemediaobject> </para></entry><entry colsep="1" rowsep="1"><para>This information is out-of-date, as with newer FreeBSD versions these parameters can be tuned at runtime via sysctl. We're looking for contributions to update this page</para></entry></row></tbody></tgroup></informaltable><para>In order to run diskd you may need to tweak your kernel settings. Try setting in the kernel config file (larger values may be needed for very busy caches): </para><screen><![CDATA[options         MSGMNB=8192     # max # of bytes in a queue
options         MSGMNI=40       # number of message queue identifiers
options         MSGSEG=512      # number of message segments per queue
options         MSGSSZ=64       # size of a message segment
options         MSGTQL=2048     # max messages in system
]]><![CDATA[
options SHMSEG=16
options SHMMNI=32
options SHMMAX=2097152
options SHMALL=4096
options MAXFILES=16384]]></screen><!--rule (<hr>) is not applicable to DocBook--><para> Back to the <ulink url="https://wiki.squid-cache.org/SquidFaq/SystemSpecificOptimizations/SquidFaq#">SquidFaq</ulink> </para></section></section></article>