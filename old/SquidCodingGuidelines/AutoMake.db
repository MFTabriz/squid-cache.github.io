<?xml version="1.0" encoding="utf-8"?><!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>SquidCodingGuidelines/AutoMake</title><revhistory><revision><revnumber>2</revnumber><date>2020-02-11 23:46:30</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>1</revnumber><date>2020-02-11 23:37:42</date><authorinitials>AmosJeffries</authorinitials><revremark>separate automake / make details from general guidelines page</revremark></revision></revhistory></articleinfo><itemizedlist><listitem><para>Back to <ulink url="https://wiki.squid-cache.org/SquidCodingGuidelines/AutoMake/SquidCodingGuidelines#">SquidCodingGuidelines</ulink>. </para></listitem><listitem><para>Back to <ulink url="https://wiki.squid-cache.org/SquidCodingGuidelines/AutoMake/DeveloperResources#">DeveloperResources</ulink>. </para></listitem></itemizedlist><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> details labeled ENFORCED are checked and forced by source testing mechanisms. </para></listitem></itemizedlist><section><title>Automake Syntax Guidelines</title><section><title>Makefile substitution variables</title><para>ENFORCED: </para><itemizedlist><listitem><para>Makefile.am must use the $(DEFAULT_FOO) form for autoconf variables passed with AC_SUBST(DEFAULT_FOO). </para></listitem></itemizedlist></section><section><title>File naming</title><itemizedlist><listitem><para>.h files should only declare one class or a collection of simple, closely related classes. </para></listitem><listitem><para>No two file names that differ only in capitalization </para></listitem><listitem><para>For new group of files, follow <ulink url="https://wiki.squid-cache.org/SquidCodingGuidelines/AutoMake/Features/SourceLayout#">Features/SourceLayout</ulink> </para></listitem><listitem><para>convenience libraries should be named for the subdirectory they are within </para><itemizedlist><listitem override="none"><para>for example; foo/libfoo.la or foo/libfoosomething.la </para></listitem></itemizedlist></listitem><listitem><para>conveniece library names must contain only alphanumeric characters 0-9 a-z, avoid upper case or punctuation </para></listitem></itemizedlist><para>ENFORCED: </para><itemizedlist><listitem><para>.h files MUST be parseable as a single translation unit </para><para> (ie it includes it's dependent headers / forward declares classes as needed). </para></listitem></itemizedlist></section><section><title>Component Macros in Automake</title><para>Squid uses autoconf defined macros to eliminate experimental or optional components at build time. </para><itemizedlist><listitem><para>name for variables passed to automake code should start with ENABLE_ </para></listitem></itemizedlist><para>Example usage: </para><screen><![CDATA[if ENABLE_FOO
FOO_SRC=foo.h foo.cc
FOO_LIBS=foo.la
else
FOO_SRC=
FOO_LIBS=
endif
]]><![CDATA[
squid_SOURCES= $(FOO_SRC) ...
LDADD = $(FOO_LIBS)]]></screen></section></section></article>