<?xml version="1.0" encoding="utf-8"?><!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>Features/AddonHelpers</title><revhistory><revision><revnumber>53</revnumber><date>2019-08-07 16:39:11</date><authorinitials>AlexRousskov</authorinitials><revremark>Improved consistency and detail of certificate generator and validator parameter syntax descriptions. Needs more work.</revremark></revision><revision><revnumber>52</revnumber><date>2019-05-11 06:04:03</date><authorinitials>AmosJeffries</authorinitials><revremark>clarify the shutdown details and fix some typos</revremark></revision><revision><revnumber>51</revnumber><date>2018-11-05 17:18:19</date><authorinitials>AlexRousskov</authorinitials><revremark>Missed a period.</revremark></revision><revision><revnumber>50</revnumber><date>2018-11-05 17:17:22</date><authorinitials>AlexRousskov</authorinitials><revremark>Documented primary helper states (as of master c002f0e)</revremark></revision><revision><revnumber>49</revnumber><date>2018-10-04 23:33:33</date><authorinitials>SelcukAyguney</authorinitials><revremark>Fixed errors related to SSL server certificate validator</revremark></revision><revision><revnumber>48</revnumber><date>2018-08-22 06:40:21</date><authorinitials>AmosJeffries</authorinitials><revremark>remove use of the word 'number' to avoid confusion with channel-ID text.</revremark></revision><revision><revnumber>47</revnumber><date>2018-08-15 13:47:32</date><authorinitials>AmosJeffries</authorinitials><revremark>mention result of Squid-4 change to %DATA bevahiour</revremark></revision><revision><revnumber>46</revnumber><date>2015-01-04 09:07:08</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>45</revnumber><date>2015-01-04 09:06:34</date><authorinitials>AmosJeffries</authorinitials><revremark>Go version 1.12.1 helpers seems not to die horribly. Thanks to Eliezer for testing.</revremark></revision><revision><revnumber>44</revnumber><date>2014-10-08 14:51:55</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>43</revnumber><date>2014-09-24 04:07:04</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>42</revnumber><date>2014-07-31 10:03:40</date><authorinitials>AmosJeffries</authorinitials><revremark>document key-extras and some other minor updates</revremark></revision><revision><revnumber>41</revnumber><date>2014-07-12 10:51:36</date><authorinitials>AmosJeffries</authorinitials><revremark>update after clt_conn_tag feature commit to trunk</revremark></revision><revision><revnumber>40</revnumber><date>2014-05-29 08:04:55</date><authorinitials>AmosJeffries</authorinitials><revremark>update Bearer kv-pairs</revremark></revision><revision><revnumber>39</revnumber><date>2013-12-10 22:36:38</date><authorinitials>AmosJeffries</authorinitials><revremark>list details known about some langauges used to create helpers</revremark></revision><revision><revnumber>38</revnumber><date>2013-10-30 04:22:58</date><authorinitials>AlexRousskov</authorinitials><revremark>Clarified which key=value pairs are sent to redirectors today.</revremark></revision><revision><revnumber>37</revnumber><date>2013-10-28 14:12:13</date><authorinitials>AmosJeffries</authorinitials><revremark>mark which helper APIs kv-pair responses are mapped to NotePair for logging.</revremark></revision><revision><revnumber>36</revnumber><date>2013-10-01 23:42:12</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>35</revnumber><date>2013-08-25 15:56:48</date><authorinitials>FrancescoChemolli</authorinitials><revremark>adapted documentation on kv-pair format</revremark></revision><revision><revnumber>34</revnumber><date>2013-06-06 14:39:43</date><authorinitials>ChristosTsantilas</authorinitials></revision><revision><revnumber>33</revnumber><date>2013-04-18 12:24:27</date><authorinitials>AmosJeffries</authorinitials><revremark>move the store-url note to the end of the syntax docs for inclusion into the StoreID feature page</revremark></revision><revision><revnumber>32</revnumber><date>2013-04-18 12:15:16</date><authorinitials>AmosJeffries</authorinitials><revremark>add Store-ID protocol documentation</revremark></revision><revision><revnumber>31</revnumber><date>2013-02-20 10:17:57</date><authorinitials>AmosJeffries</authorinitials><revremark>Add proposed Bearer authentication helper interface.</revremark></revision><revision><revnumber>30</revnumber><date>2013-01-24 10:01:42</date><authorinitials>AmosJeffries</authorinitials><revremark>highlight that helper I/O is in a loop.</revremark></revision><revision><revnumber>29</revnumber><date>2012-11-28 11:49:33</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>28</revnumber><date>2012-11-28 09:45:09</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>27</revnumber><date>2012-11-28 08:08:57</date><authorinitials>AmosJeffries</authorinitials><revremark>change key-pair to kv-pair. Document protocol stage-2 changes in trunk for release in Squid-3.4.</revremark></revision><revision><revnumber>26</revnumber><date>2012-11-23 13:36:13</date><authorinitials>ChristosTsantilas</authorinitials></revision><revision><revnumber>25</revnumber><date>2012-11-10 11:42:01</date><authorinitials>AmosJeffries</authorinitials><revremark>ACL does accept OK result code (copy-paste typo). better formatting on NTLM notes.</revremark></revision><revision><revnumber>24</revnumber><date>2012-10-30 02:48:17</date><authorinitials>AmosJeffries</authorinitials><revremark>update unlinkd protocol specs. (the code was unused, just the LF character for queue counting). also remove unused ERR code from ssl helpers</revremark></revision><revision><revnumber>23</revnumber><date>2012-10-30 02:16:20</date><authorinitials>AmosJeffries</authorinitials><revremark>Document helper API response code changes in 3.3</revremark></revision><revision><revnumber>22</revnumber><date>2012-10-20 01:02:37</date><authorinitials>AmosJeffries</authorinitials><revremark>add several FAQ which keep coming up in the help on IRC and squid-users, and FAQ-ize the details section.</revremark></revision><revision><revnumber>21</revnumber><date>2012-09-22 12:10:15</date><authorinitials>AmosJeffries</authorinitials><revremark>add mention of blob token fields which exist in Negotiate protocol.</revremark></revision><revision><revnumber>20</revnumber><date>2012-09-20 06:36:08</date><authorinitials>AmosJeffries</authorinitials><revremark>typos and simpler description of the format.</revremark></revision><revision><revnumber>19</revnumber><date>2012-09-19 22:07:41</date><authorinitials>ChristosTsantilas</authorinitials></revision><revision><revnumber>18</revnumber><date>2012-09-19 21:57:25</date><authorinitials>ChristosTsantilas</authorinitials></revision><revision><revnumber>17</revnumber><date>2012-09-19 21:40:00</date><authorinitials>ChristosTsantilas</authorinitials></revision><revision><revnumber>16</revnumber><date>2012-09-17 07:05:00</date><authorinitials>AmosJeffries</authorinitials><revremark>remove mention of LD. It is obsolete and not supported in any current release.</revremark></revision><revision><revnumber>15</revnumber><date>2012-06-12 09:04:47</date><authorinitials>AmosJeffries</authorinitials><revremark>key-pair on external ACL is optional</revremark></revision><revision><revnumber>14</revnumber><date>2012-02-27 21:53:58</date><authorinitials>AmosJeffries</authorinitials><revremark>add unlinkd section to the summary.</revremark></revision><revision><revnumber>13</revnumber><date>2012-01-01 09:55:38</date><authorinitials>AmosJeffries</authorinitials><revremark>document the unlinkd_program interface</revremark></revision><revision><revnumber>12</revnumber><date>2011-10-11 04:55:42</date><authorinitials>AmosJeffries</authorinitials><revremark>magic tag terminator fix</revremark></revision><revision><revnumber>11</revnumber><date>2011-09-18 22:28:01</date><authorinitials>AmosJeffries</authorinitials><revremark>typo in wikilink</revremark></revision><revision><revnumber>10</revnumber><date>2011-06-23 00:52:55</date><authorinitials>AmosJeffries</authorinitials><revremark>document ssl_crtd helepr protocol</revremark></revision><revision><revnumber>9</revnumber><date>2011-05-08 13:06:47</date><authorinitials>AmosJeffries</authorinitials><revremark>details which NTLM/Negotiate lines are to and which are from the helper</revremark></revision><revision><revnumber>8</revnumber><date>2011-03-17 11:11:32</date><authorinitials>AmosJeffries</authorinitials><revremark>squid-2 appears to send urlgroup over to re-writers specially.</revremark></revision><revision><revnumber>7</revnumber><date>2011-03-17 08:48:40</date><authorinitials>AmosJeffries</authorinitials><revremark>mucked up the ip/fqdn syntax description.</revremark></revision><revision><revnumber>6</revnumber><date>2011-03-17 08:43:07</date><authorinitials>AmosJeffries</authorinitials><revremark>add tag for omitting the general URL re-write disclaimers</revremark></revision><revision><revnumber>5</revnumber><date>2011-03-17 08:07:29</date><authorinitials>AmosJeffries</authorinitials><revremark>typo</revremark></revision><revision><revnumber>4</revnumber><date>2011-03-17 08:06:28</date><authorinitials>AmosJeffries</authorinitials><revremark>tag protocol descriptions for wiki page includes</revremark></revision><revision><revnumber>3</revnumber><date>2011-03-17 07:24:00</date><authorinitials>AmosJeffries</authorinitials><revremark>add log daemon protocol</revremark></revision><revision><revnumber>2</revnumber><date>2011-03-17 07:14:56</date><authorinitials>AmosJeffries</authorinitials><revremark>typo in basic description and add digest.</revremark></revision><revision><revnumber>1</revnumber><date>2011-03-17 06:50:50</date><authorinitials>AmosJeffries</authorinitials><revremark>Document the helper protocols as the exist today.</revremark></revision></revhistory></articleinfo><section><title>Feature: Add-On Helpers for Request Manipulation</title><itemizedlist><listitem><para><emphasis role="strong">Goal</emphasis>: Support simple customization of request handling for local requirements. </para></listitem><listitem><para><emphasis role="strong">Status</emphasis>: Completed. 2.5 </para></listitem><listitem><para><emphasis role="strong">Version</emphasis>: 2.5 </para></listitem></itemizedlist><itemizedlist><listitem><para><emphasis role="strong">More</emphasis>: </para><itemizedlist><listitem override="none"><para>(NTLM) <ulink url="http://squid.sourceforge.net/ntlm/squid_helper_protocol.html"/> </para><para> (Digest auth)  <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/KnowledgeBase/LdapBackedDigestAuthentication#">KnowledgeBase/LdapBackedDigestAuthentication</ulink> </para><para> (Kerberos auth) <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/ConfigExamples/Authenticate/Kerberos#">ConfigExamples/Authenticate/Kerberos</ulink> </para></listitem></itemizedlist></listitem></itemizedlist><section><title>Details</title><para>Every network and installation have their own criteria for operation. The squid developers and community do not have the time or inclination to write code for every minor situation. Instead we provide ways to easily extend various operations with local add-on scripts or programs we call helpers. </para><section><title>What language are helper meant to be written in?</title><para>Helpers can be written in any language you like. They can be executable programs or interpreted scripts. </para><para>The helpers bundled with Squid are currently written in Bash shell script, awk script, perl script, and C++. There are also frameworks available for helpers built in Python or Ruby. </para><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="15" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/alert.png" width="15"/></imageobject><textobject><phrase>/!\</phrase></textobject></inlinemediaobject> There are several languages which encounter difficulties though: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> Perl, Python </para></entry><entry colsep="1" rowsep="1"><para> Certain methods of writing output to stdout automatically append newline characters. Care must be taken that only one set of newlines are output with the response. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> PHP </para></entry><entry colsep="1" rowsep="1"><para> Various versions of the Zend 5.x engine have bugs related to I/O and execution timeouts. Others have bugs in configuration settings used to control these timeouts. In general it is best to avoid PHP entirely unless one wants to spend a great deal of time testing and finding workaround for these issues. Some of these bugs do not have solutions. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> Go </para></entry><entry colsep="1" rowsep="1"><para> read() operation seems to have some form of timeout on threads which returns socket-closed signals. Causing a multi-threaded concurrent helper to exit if its least-used thread times out. There is no known workaround or solution for this. </para><para> <inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> As of Go version 1.12.1 the issue appears to be resolved. </para></entry></row></tbody></tgroup></informaltable></listitem></itemizedlist></section><section><title>How do the helpers communicate with Squid?</title><para>The interface with Squid is very simple. The helper is passed a limited amount of information on stdin to perform their expected task. The result is passed back to Squid via stdout. With any errors or debugging traces sent back on stderr. </para><itemizedlist><listitem><para>The helper is expected to wait for input before responding. Early responses or unexpected lines arriving to Squid on stdin will result in the helper being shut down with errors. If that happens often Squid may terminate as well. </para></listitem><listitem><para>The helper is expected to handle multiple lookups by Squid. It is a terrible drag on HTTP speed to be constantly re-starting helpers. If that happens often enough Squid may terminate as well. </para></listitem></itemizedlist><para>See the particular interface protocols below for details about the line syntax the helper is expected to receive and send on each interface. </para></section><section><title>Why is my helper not starting up with Squid?</title><para>Squid-3.2 and newer support dynamic helper initialization. That means the helper is only started if it needs to be. If Squid is configured with startup=N value greater than 0 you can expect that many of your helper to be started when Squid starts. But this is not necessarily a desirable thing for Squid needing fast startup or restart times. </para><para>With startup=0 configured the first HTTP request through Squid is expected to start at least one instance for most of the helpers. But if for example an external ACL is configured and is only tested on rare occasions its helper will not be started until that rare occasion happens for the first time. </para></section><section><title>What happens when Squid shuts down or reconfigures?</title><para>When shutting down, reconfiguring, or in other times Squid needs to shutdown a helper Squid schedules closure of the stdin connection of the helper. When all the in-progress lookups are completed the helper should receive this close signal when reading stdin. </para><para>Shutting down or restarting are limited by the <ulink url="http://www.squid-cache.org/Doc/config/shutdown_timeout#">shutdown_timeout</ulink> which may cause Squid to abort earlier than receiving all the responses. If this happens the client connections are also being terminated just as abruptly as the helper - so the lost helper responses are not an issue. </para></section><section><title>Can I write a helper that talks to Squid on more than one interface?</title><para>You can. In a way. </para><para>Squid runs the configured helper for each interface as a separate child process. Your helper can be written to detect other running instances of itself and communicate between them, effectively sharing memory and/or state outside of Squid regardless of the interface Squid is using to run each instance. </para><para>NP: Just keep in mind that the number of instances (children) running on each interface is configurable and could be anything from zero to many hundreds. So do not make any assumptions about which interface another instance is running on. </para></section></section><section><title>Squid operations which provide a helper interface</title><para>Squid-2.6 and later all support: </para><itemizedlist><listitem><para>URL manipulation: re-writing and redirection </para><itemizedlist><listitem><para>(<ulink url="http://www.squid-cache.org/Doc/config/url_rewrite_program#">url_rewrite_program</ulink>, <ulink url="http://www.squid-cache.org/Doc/config/url_rewrite_access#">url_rewrite_access</ulink>) </para></listitem><listitem><para>Specific feature details at <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Features/Redirectors#">Features/Redirectors</ulink> </para></listitem></itemizedlist></listitem><listitem><para>ACL logic tests </para><itemizedlist><listitem><para>(<ulink url="http://www.squid-cache.org/Doc/config/external_acl_type#">external_acl_type</ulink>) </para></listitem></itemizedlist></listitem><listitem><para>Authentication </para><itemizedlist><listitem><para>(<ulink url="http://www.squid-cache.org/Doc/config/auth_param#">auth_param</ulink>) </para></listitem><listitem><para>Specific feature details at <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Features/Authentication#">Features/Authentication</ulink> <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Features/NegotiateAuthentication#">Features/NegotiateAuthentication</ulink> </para></listitem></itemizedlist></listitem><listitem><para>cache file eraser </para><itemizedlist><listitem><para><ulink url="http://www.squid-cache.org/Doc/config/unlinkd_program#">unlinkd_program</ulink> </para></listitem></itemizedlist></listitem><listitem><para>DNS lookup (removed in Squid-3.5) </para><itemizedlist><listitem><para><ulink url="http://www.squid-cache.org/Doc/config/dns_program#">dns_program</ulink> </para></listitem></itemizedlist></listitem></itemizedlist><para>Squid-2.7 (only): </para><itemizedlist><listitem><para>HTTP Server redirection replies </para><itemizedlist><listitem><para>(<ulink url="http://www.squid-cache.org/Doc/config/location_rewrite_program#">location_rewrite_program</ulink>, <ulink url="http://www.squid-cache.org/Doc/config/location_rewrite_access#">location_rewrite_access</ulink>) </para></listitem></itemizedlist></listitem><listitem><para>Cache object de-duplication </para><itemizedlist><listitem><para>(<ulink url="http://www.squid-cache.org/Doc/config/storeurl_rewrite_program#">storeurl_rewrite_program</ulink>, <ulink url="http://www.squid-cache.org/Doc/config/storeurl_rewrite_access#">storeurl_rewrite_access</ulink>) </para></listitem><listitem><para>Specific feature details at <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Features/StoreUrlRewrite#">Features/StoreUrlRewrite</ulink> </para></listitem></itemizedlist></listitem></itemizedlist><para>Squid-2.7 and Squid-3.1+ support: </para><itemizedlist><listitem><para>Logging </para><itemizedlist><listitem><para>(<ulink url="http://www.squid-cache.org/Doc/config/logfile_daemon#">logfile_daemon</ulink>) </para></listitem><listitem><para>Specific feature details at <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Features/LogModules#">Features/LogModules</ulink> </para></listitem></itemizedlist></listitem></itemizedlist><para>Squid-3.1+ support: </para><itemizedlist><listitem><para>SSL certificate generation (3.1.12.1 and later). </para></listitem></itemizedlist><para>Squid-3.4+ support: </para><itemizedlist><listitem><para>Cache object de-duplication </para><itemizedlist><listitem><para>(<ulink url="http://www.squid-cache.org/Doc/config/store_id_program#">store_id_program</ulink>, <ulink url="http://www.squid-cache.org/Doc/config/store_id_access#">store_id_access</ulink>, <ulink url="http://www.squid-cache.org/Doc/config/store_id_children#">store_id_children</ulink>, <ulink url="http://www.squid-cache.org/Doc/config/store_id_bypass#">store_id_bypass</ulink>) </para></listitem><listitem><para>Specific feature details at <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Features/StoreID#">Features/StoreID</ulink> </para></listitem></itemizedlist></listitem><listitem><para>SSL certificate validation </para><itemizedlist><listitem><para>(<ulink url="http://www.squid-cache.org/Doc/config/sslcrtvalidator_program#">sslcrtvalidator_program</ulink>, <ulink url="http://www.squid-cache.org/Doc/config/sslcrtvalidator_children#">sslcrtvalidator_children</ulink>) </para></listitem><listitem><para>Specific feature details at <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Features/SslServerCertValidator#">Features/SslServerCertValidator</ulink> </para></listitem></itemizedlist></listitem></itemizedlist><para>squid-3.5+ support: </para><itemizedlist><listitem><para>flexible key-extras extensions to helper lookup request lines </para></listitem></itemizedlist><para>Squid-3.1 and later also support <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Features/eCAP#">eCAP plugins</ulink> and <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Features/ICAP#">ICAP services</ulink> which differ from helper scripts in many ways. </para></section><section><title>Helper states</title><para>An individual helper <emphasis>process</emphasis> may be in one or more of the following states: </para><informaltable><tgroup cols="3"><colspec colname="col_0"/><colspec colname="col_1"/><colspec colname="col_2"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> <emphasis role="strong">Key </emphasis> </para></entry><entry colsep="1" rowsep="1"><para>  <emphasis role="strong">Name</emphasis> </para></entry><entry colsep="1" rowsep="1"><para>  <emphasis role="strong">Meaning</emphasis> </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> B </para></entry><entry colsep="1" rowsep="1"><para> BUSY </para></entry><entry colsep="1" rowsep="1"><para> Squid is expecting a response from the helper process. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> W </para></entry><entry colsep="1" rowsep="1"><para> WRITING </para></entry><entry colsep="1" rowsep="1"><para> Squid is sending one or more requests to a stateless helper process. Squid has not been notified that all the sent data has been written. A WRITING helper is a BUSY helper. Please note that <emphasis>reporting</emphasis> this state is currently not supported for stateful helpers. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> R </para></entry><entry colsep="1" rowsep="1"><para> RESERVED </para></entry><entry colsep="1" rowsep="1"><para> Squid is sending a request to a <emphasis>stateful</emphasis> helper process. Squid has not been notified that all the sent data has been written. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> P </para></entry><entry colsep="1" rowsep="1"><para> PLACEHOLDER </para></entry><entry colsep="1" rowsep="1"><para> There is at least one master transaction waiting for this stateful helper (but not necessarily this specific stateful helper <emphasis>process</emphasis>) to become available (i.e. not BUSY). </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> C </para></entry><entry colsep="1" rowsep="1"><para> CLOSING </para></entry><entry colsep="1" rowsep="1"><para> Squid closed its writing socket for the helper process, but the helper has not quit yet (or, to be more precise, has not closed its stdout yet). </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> S </para></entry><entry colsep="1" rowsep="1"><para> SHUTDOWN PENDING </para></entry><entry colsep="1" rowsep="1"><para> Squid marked this helper process for eventual closure but has not yet initiated that closure (usually because the helper is still BUSY). </para></entry></row></tbody></tgroup></informaltable><para>The above table does not reflect some esoteric corner cases, especially when it comes for conditions for ending a helper state. For example, a stateful helper  process may stop being RESERVED for reasons other than writing the entire request data to the helper process. </para><para>Squid <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Features/CacheManager#">Cache Manager</ulink> reports individual helper states on helper-specific pages such as mgr:store_io. </para></section><section><title>Helper protocols</title><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> Squid-2.6 and later all support concurrency, however the bundled helpers and many third-party commercial helpers do not. This is changing, the use of concurrency is encouraged to improve performance. The relevant squid.conf concurrency setting must match the helper concurrency support. The <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Features/HelperMultiplexer#">helper multiplexer</ulink> wrapper can be used to add concurrency benefits to most non-concurrent helpers. </para><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="15" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/alert.png" width="15"/></imageobject><textobject><phrase>/!\</phrase></textobject></inlinemediaobject> <emphasis role="strong">WARNING:</emphasis> For every line sent by Squid exactly one line is expected back. Some script language such as perl and python need to be careful about the number of newlines in their output. </para><para><inlinemediaobject><imageobject><imagedata depth="15" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/alert.png" width="15"/></imageobject><textobject><phrase>/!\</phrase></textobject></inlinemediaobject> Note that the helper programs other than logging can not use buffered I/O. </para></listitem></itemizedlist><section><title>Key=Value pairs (kv-pairs) format</title><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> Relevant to Squid-3.4 and later </para><para>The interface for all helpers has been extended to support arbitrary lists of key=value pairs, with the syntax <code> key=value </code>. Some keys have special meaning to Squid, as documented here. All messages from squid are URL-escaped (the <code> rfc1738_unescape </code> from rfc1738.h can be used to decode them. For responses, the safe way is to either URL-escape, or to enclose the value in double_quotes (&quot;); any double-quotes or backslashes (\) in the value need to be prefixed by a backslash, \r and \n are replaced respectively by CR and LF </para><para>Some example key values: </para><screen><![CDATA[                user=John%20Smith
                user="John Smith"
                user="J. \"Bob\" Smith"]]></screen></section><section><title>URL manipulation</title><para>Input line received from Squid: </para><screen><![CDATA[[channel-ID] URL [key-extras]]]></screen><glosslist><glossentry><glossterm>channel-ID</glossterm><glossdef><itemizedlist><listitem override="none"><para>This is an ID for the line when concurrency is enabled. When concurrency is turned off (set to <emphasis role="strong">1</emphasis>) this field and the following space will be completely missing. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>URL</glossterm><glossdef><itemizedlist><listitem override="none"><para>The URL received from the client. In Squid with ICAP support, this is the URL after ICAP REQMOD has taken place. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>key-extras</glossterm><glossdef><itemizedlist><listitem override="none"><para>Starting with <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.5#">Squid-3.5</ulink> additional parameters passed to the helper which may be configured with <ulink url="http://www.squid-cache.org/Doc/config/url_rewrite_extras#">url_rewrite_extras</ulink>. For backward compatibility the default key-extras for URL helpers matches the format fields sent by <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.4#">Squid-3.4</ulink> and older in this field position: </para></listitem></itemizedlist><itemizedlist><listitem override="none"><screen><![CDATA[ ip/fqdn ident method [urlgroup] kv-pair]]></screen></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>ip</glossterm><glossdef><itemizedlist><listitem override="none"><para>This is the IP address of the client. Followed by a slash (<emphasis role="strong">/</emphasis>) as shown above. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>fqdn</glossterm><glossdef><itemizedlist><listitem override="none"><para>The FQDN rDNS of the client, if any is known. Squid does not normally perform lookup unless needed by logging or ACLs. Squid does not wait for any results unless ACLs are configured to wait. If none is available <emphasis role="strong">-</emphasis> will be sent to the helper instead. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>ident</glossterm><glossdef><itemizedlist><listitem override="none"><para>The IDENT protocol username (if known) of the client machine. Squid will not wait for IDENT username to become known unless there are ACL which depend on it. So at the time re-writers are run the IDENT username may not yet be known. If none is available <emphasis role="strong">-</emphasis> will be sent to the helper instead. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>method</glossterm><glossdef><itemizedlist><listitem override="none"><para>The HTTP request method. URL alterations and particularly redirection are only possible on certain methods, and some such as POST and CONNECT require special care. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>urlgroup</glossterm><glossdef><itemizedlist><listitem override="none"><para>Squid-2 will send this field with the URL-grouping tag which can be configured on <ulink url="http://www.squid-cache.org/Doc/config/http_port#">http_port</ulink>. Squid-3.x will not send this field. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>kv-pair</glossterm><glossdef><itemizedlist><listitem override="none"><para>One or more key=value pairs. Only &quot;myip&quot; and &quot;myport&quot; pairs documented below were ever defined and are sent unconditionally by <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.4#">Squid-3.4</ulink> and older: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> myip=... </para></entry><entry colsep="1" rowsep="1"><para> Squid receiving address </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> myport=... </para></entry><entry colsep="1" rowsep="1"><para> Squid receiving port </para></entry></row></tbody></tgroup></informaltable></listitem></itemizedlist></glossdef></glossentry></glosslist><section><title>HTTP Redirection</title><para>Redirection can be performed by helpers on the <ulink url="http://www.squid-cache.org/Doc/config/url_rewrite_program#">url_rewrite_program</ulink> interface. Lines performing either redirect or re-write can be produced by the same helpers on a per-request basis. Redirect is preferred since re-writing URLs introduces a large number of problems into the client HTTP experience. </para><para>The input line received from Squid is detailed by the section above. </para><para>Redirectors send a slightly different format of line back to Squid.  </para><para>Result line sent back to Squid: </para><screen><![CDATA[[channel-ID] [result] [kv-pairs] [status:URL]]]></screen><glosslist><glossentry><glossterm>channel-ID</glossterm><glossdef><itemizedlist><listitem override="none"><para>When a concurrency <emphasis role="strong">channel-ID</emphasis> is received it must be sent back to Squid unchanged as the first entry on the line. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>result</glossterm><glossdef><itemizedlist><listitem override="none"><para>One of the result codes: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> OK </para></entry><entry colsep="1" rowsep="1"><para> Success. A new URL is presented. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> ERR </para></entry><entry colsep="1" rowsep="1"><para> Success. No action for this URL. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> BH </para></entry><entry colsep="1" rowsep="1"><para> Failure. The helper encountered a problem. </para></entry></row></tbody></tgroup></informaltable></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> the result field is only accepted by <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.4#">Squid-3.4</ulink> and newer. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>kv-pair</glossterm><glossdef><itemizedlist><listitem override="none"><para>One or more key=value pairs. The key names reserved on this interface for HTTP redirection: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> clt_conn_tag=... </para></entry><entry colsep="1" rowsep="1"><para> Tag the client TCP connection (<ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.5#">Squid-3.5</ulink>) </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> message=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> status=... </para></entry><entry colsep="1" rowsep="1"><para> HTTP status code to use on the redirect. Must be one of: 301, 302, 303, 307, 308 </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> tag=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> ttl=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> url=... </para></entry><entry colsep="1" rowsep="1"><para> redirect the client to given URL </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> *_=... </para></entry><entry colsep="1" rowsep="1"><para> Key names ending in (_) are reserved for local administrators use. </para></entry></row></tbody></tgroup></informaltable></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> the kv-pair field is only accepted by <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.4#">Squid-3.4</ulink> and newer. </para></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> the kv-pair returned by this helper can be logged by the <emphasis role="strong">%note</emphasis> <ulink url="http://www.squid-cache.org/Doc/config/logformat#">logformat</ulink> code. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>status</glossterm><glossdef><itemizedlist><listitem override="none"><para>The HTTP 301, 302 or 307 status code. Please see section 10.3 of RFC <ulink url="https://tools.ietf.org/rfc/rfc2616#">2616</ulink> for an explanation of the HTTP redirect codes and which request methods they may be sent on. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>URL</glossterm><glossdef><itemizedlist><listitem override="none"><para>The URL to be used instead of the one sent by the client. This must be an absolute URL. ie starting with <ulink url="http://"/> or <ulink url="ftp://"/> etc. </para></listitem></itemizedlist></glossdef><glossdef><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> If no action is required leave status:URL area blank. </para></glossdef><glossdef><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> The <emphasis role="strong">status</emphasis> and <emphasis role="strong">URL</emphasis> are separated by a colon (<emphasis role="strong">:</emphasis>) as shown above instead of whitespace. </para></glossdef></glossentry></glosslist></section><section><title>URL Re-Writing (Mangling)</title><para>URL re-writing can be performed by helpers on the <ulink url="http://www.squid-cache.org/Doc/config/url_rewrite_program#">url_rewrite_program</ulink>, <ulink url="http://www.squid-cache.org/Doc/config/storeurl_rewrite_program#">storeurl_rewrite_program</ulink> and <ulink url="http://www.squid-cache.org/Doc/config/location_rewrite_program#">location_rewrite_program</ulink> interfaces. </para><para>WARNING: when used on the url_rewrite_program interface re-writing URLs introduces a large number of problems into the client HTTP experience. Some of these problems can be mitigated with a paired helper running on the <ulink url="http://www.squid-cache.org/Doc/config/location_rewrite_program#">location_rewrite_program</ulink> interface de-mangling the server redirection URLs. </para><para>Result line sent back to Squid: </para><screen><![CDATA[[channel-ID] [result] [kv-pair] [URL]]]></screen><glosslist><glossentry><glossterm>channel-ID</glossterm><glossdef><itemizedlist><listitem override="none"><para>When a concurrency <emphasis role="strong">channel-ID</emphasis> is received it must be sent back to Squid unchanged as the first entry on the line. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>result</glossterm><glossdef><itemizedlist><listitem override="none"><para>One of the result codes: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> OK </para></entry><entry colsep="1" rowsep="1"><para> Success. A new URL is presented </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> ERR </para></entry><entry colsep="1" rowsep="1"><para> Success. No change for this URL. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> BH </para></entry><entry colsep="1" rowsep="1"><para> Failure. The helper encountered a problem. </para></entry></row></tbody></tgroup></informaltable></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> the result field is only accepted by <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.4#">Squid-3.4</ulink> and newer. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>kv-pair</glossterm><glossdef><itemizedlist><listitem override="none"><para>One or more key=value pairs. The key names reserved on this interface for URL re-writing: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> clt_conn_tag=... </para></entry><entry colsep="1" rowsep="1"><para> Tag the client TCP connection (<ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.5#">Squid-3.5</ulink>) </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> message=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> rewrite-url=... </para></entry><entry colsep="1" rowsep="1"><para> re-write the transaction to the given URL. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> tag=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> ttl=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> *_=... </para></entry><entry colsep="1" rowsep="1"><para> Key names ending in (_) are reserved for local administrators use. </para></entry></row></tbody></tgroup></informaltable></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> the kv-pair field is only accepted by <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.4#">Squid-3.4</ulink> and newer. </para></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> the kv-pair returned by this helper can be logged by the <emphasis role="strong">%note</emphasis> <ulink url="http://www.squid-cache.org/Doc/config/logformat#">logformat</ulink> code. </para></listitem></itemizedlist></glossdef></glossentry></glosslist><glosslist><glossentry><glossterm>URL</glossterm><glossdef><itemizedlist><listitem override="none"><para>The URL to be used instead of the one sent by the client. If no action is required leave the URL field blank. The URL sent must be an absolute URL. ie starting with <ulink url="http://"/> or <ulink url="ftp://"/> etc. </para></listitem></itemizedlist></glossdef></glossentry></glosslist></section><section><title>Store ID de-duplication</title><para>URL to Store-ID mapping can be performed by helpers on the <ulink url="http://www.squid-cache.org/Doc/config/storeid_rewrite_program#">storeid_rewrite_program</ulink> interface. </para><para>WARNING: care must be taken that the URLs de-duplicated onto one shared ID are actually duplicates. Clients needing to revalidate will cause the cached object to be sourced from either of the duplicate locations. If they are not real duplicates this can randomly cause major issues with the client experience. </para><para>Result line sent back to Squid: </para><screen><![CDATA[[channel-ID] result kv-pair]]></screen><glosslist><glossentry><glossterm>channel-ID</glossterm><glossdef><itemizedlist><listitem override="none"><para>When a concurrency <emphasis role="strong">channel-ID</emphasis> is received it must be sent back to Squid unchanged as the first entry on the line. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>result</glossterm><glossdef><itemizedlist><listitem override="none"><para>One of the result codes: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> OK </para></entry><entry colsep="1" rowsep="1"><para> Success. A new storage ID is presented for this URL. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> ERR </para></entry><entry colsep="1" rowsep="1"><para> Success. No change for this URL. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> BH </para></entry><entry colsep="1" rowsep="1"><para> Failure. The helper encountered a problem. </para></entry></row></tbody></tgroup></informaltable></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>kv-pair</glossterm><glossdef><itemizedlist><listitem override="none"><para>One or more key=value pairs. The key names reserved on this interface for URL re-writing: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> clt_conn_tag=... </para></entry><entry colsep="1" rowsep="1"><para> Tag the client TCP connection (<ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.5#">Squid-3.5</ulink>) </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> message=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> store-id=... </para></entry><entry colsep="1" rowsep="1"><para> set the cache storage ID for this URL. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> tag=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> ttl=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> *_=... </para></entry><entry colsep="1" rowsep="1"><para> Key names ending in (_) are reserved for local administrators use. </para></entry></row></tbody></tgroup></informaltable></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> the kv-pair returned by this helper can be logged by the <emphasis role="strong">%note</emphasis> <ulink url="http://www.squid-cache.org/Doc/config/logformat#">logformat</ulink> code. </para></listitem></itemizedlist><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> This interface will also accept responses in the syntax delivered by <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Features/StoreUrlRewrite#">Store URL-rewrite</ulink> feature helpers written for <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-2.7#">Squid-2.7</ulink>. However thst syntax is deprecated and such helpers should be upgraded as soon as possible to use this Store-ID syntax. </para></glossdef></glossentry></glosslist></section></section><section><title>Authenticator</title><section><title>Basic Scheme</title><para>Input line received from Squid: </para><screen><![CDATA[[channel-ID] username password [key-extras]]]></screen><glosslist><glossentry><glossterm>channel-ID</glossterm><glossdef><itemizedlist><listitem override="none"><para>This is an ID for the line when concurrency is enabled. When concurrency is turned off (set to <emphasis role="strong">1</emphasis>) this field and the following space will be completely missing. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>username</glossterm><glossdef><itemizedlist><listitem override="none"><para>The username field sent by the client in HTTP headers. It may be empty or missing. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>password</glossterm><glossdef><itemizedlist><listitem override="none"><para>The password value sent by the client in HTTP headers. May be empty or missing. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>key-extras</glossterm><glossdef><itemizedlist><listitem override="none"><para>Additional parameters passed to the helper which may be configured with <ulink url="http://www.squid-cache.org/Doc/config/auth_param#">auth_param</ulink> <emphasis>key_extras</emphasis> parameter. Only available in <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.5#">Squid-3.5</ulink> and later. </para></listitem></itemizedlist></glossdef></glossentry></glosslist><para>Result line sent back to Squid: </para><screen><![CDATA[[channel-ID] result [kv-pair]]]></screen><glosslist><glossentry><glossterm>channel-ID</glossterm><glossdef><itemizedlist><listitem override="none"><para>When a concurrency <emphasis role="strong">channel-ID</emphasis> is received it must be sent back to Squid unchanged as the first entry on the line. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>result</glossterm><glossdef><itemizedlist><listitem override="none"><para>One of the result codes: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> OK </para></entry><entry colsep="1" rowsep="1"><para> Success. Valid credentials. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> ERR </para></entry><entry colsep="1" rowsep="1"><para> Success. Invalid credentials. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> BH </para></entry><entry colsep="1" rowsep="1"><para> Failure. The helper encountered a problem. </para></entry></row></tbody></tgroup></informaltable></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> the <emphasis role="strong">BH</emphasis> result code is only accepted by <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.4#">Squid-3.4</ulink> and newer. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>kv-pair</glossterm><glossdef><itemizedlist><listitem override="none"><para>One or more key=value pairs. The key names reserved on this interface: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> clt_conn_tag=... </para></entry><entry colsep="1" rowsep="1"><para> Tag the client TCP connection (<ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.5#">Squid-3.5</ulink>) </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> group=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> message=... </para></entry><entry colsep="1" rowsep="1"><para> A message string that Squid can display on an error page. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> tag=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> ttl=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> *_=... </para></entry><entry colsep="1" rowsep="1"><para> Key names ending in (_) are reserved for local administrators use. </para></entry></row></tbody></tgroup></informaltable></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> the kv-pair field is only accepted by <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.4#">Squid-3.4</ulink> and newer. </para></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> the kv-pair returned by this helper can be logged by the <emphasis role="strong">%note</emphasis> <ulink url="http://www.squid-cache.org/Doc/config/logformat#">logformat</ulink> code. </para></listitem></itemizedlist></glossdef></glossentry></glosslist></section><section><title>Bearer Scheme</title><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> the <emphasis role="strong">Bearer</emphasis> authentication scheme is <emphasis role="strong">proposed</emphasis> to be supported by <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.4#">Squid-3.4</ulink> and newer. But not yet accepted into trunk. </para></listitem></itemizedlist><para>Input line received from Squid: </para><screen><![CDATA[channel-ID b64token [key-extras]]]></screen><glosslist><glossentry><glossterm>channel-ID</glossterm><glossdef><itemizedlist><listitem override="none"><para>This is an ID for the line to support concurrent lookups. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>b64token</glossterm><glossdef><itemizedlist><listitem override="none"><para>The opaque credentials token field sent by the client in HTTP headers. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>key-extras</glossterm><glossdef><itemizedlist><listitem override="none"><para>Additional parameters passed to the helper which may be configured with <ulink url="http://www.squid-cache.org/Doc/config/auth_param#">auth_param</ulink> <emphasis>key_extras</emphasis> parameter. Only available in <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.5#">Squid-3.5</ulink> and later. </para></listitem></itemizedlist></glossdef></glossentry></glosslist><para>Result line sent back to Squid: </para><screen><![CDATA[channel-ID result [kv-pair]]]></screen><glosslist><glossentry><glossterm>channel-ID</glossterm><glossdef><itemizedlist><listitem override="none"><para>The concurrency <emphasis role="strong">channel-ID</emphasis> as received. It must be sent back to Squid unchanged as the first entry on the line. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>result</glossterm><glossdef><itemizedlist><listitem override="none"><para>One of the result codes: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> OK </para></entry><entry colsep="1" rowsep="1"><para> Success. Valid credentials. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> ERR </para></entry><entry colsep="1" rowsep="1"><para> Success. Invalid credentials. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> BH </para></entry><entry colsep="1" rowsep="1"><para> Failure. The helper encountered a problem. </para></entry></row></tbody></tgroup></informaltable></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>kv-pair</glossterm><glossdef><itemizedlist><listitem override="none"><para>One or more key=value pairs. The key names reserved on this interface: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> clt_conn_tag=... </para></entry><entry colsep="1" rowsep="1"><para> Tag the client TCP connection (<ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.5#">Squid-3.5</ulink>) </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> group=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> message=... </para></entry><entry colsep="1" rowsep="1"><para> A message string that Squid can display on an error page. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> tag=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> ttl=... </para></entry><entry colsep="1" rowsep="1"><para> The duration for which this result may be used.</para><para>If not provided the token treated as already stale (a nonce). </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> user=... </para></entry><entry colsep="1" rowsep="1"><para> The label to be used by Squid for this client request as <emphasis role="strong">&quot;username&quot;</emphasis>. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> *_=... </para></entry><entry colsep="1" rowsep="1"><para> Key names ending in (_) are reserved for local administrators use. </para></entry></row></tbody></tgroup></informaltable></listitem></itemizedlist></glossdef></glossentry></glosslist></section><section><title>Digest Scheme</title><para>Input line received from Squid: </para><screen><![CDATA[[channel-ID] "username":"realm" [key-extras]]]></screen><glosslist><glossentry><glossterm>channel-ID</glossterm><glossdef><itemizedlist><listitem override="none"><para>This is an ID for the line when concurrency is enabled. When concurrency is turned off (set to <emphasis role="strong">1</emphasis>) this field and the following space will be completely missing. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>username</glossterm><glossdef><itemizedlist><listitem override="none"><para>The username field sent by the client in HTTP headers. Sent as a &quot;double-quoted&quot; string. May be empty. It may be configured to use UTF-8 bytes instead of the ISO-8859-1 received. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>realm</glossterm><glossdef><itemizedlist><listitem override="none"><para>The digest auth realm string configured in squid.conf. Sent as a &quot;double-quoted&quot; string. </para></listitem></itemizedlist></glossdef></glossentry></glosslist><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> The <emphasis role="strong">username</emphasis> and <emphasis role="strong">realm</emphasis> strings are both double quoted (<emphasis role="strong">&quot;</emphasis>) and separated by a colon (<emphasis role="strong">:</emphasis>) as shown above. </para><glosslist><glossentry><glossterm>key-extras</glossterm><glossdef><itemizedlist><listitem override="none"><para>Additional parameters passed to the helper which may be configured with <ulink url="http://www.squid-cache.org/Doc/config/auth_param#">auth_param</ulink> <emphasis>key_extras</emphasis> parameter. Only available in <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.5#">Squid-3.5</ulink> and later. </para></listitem></itemizedlist></glossdef></glossentry></glosslist><para>Result line sent back to Squid: </para><screen><![CDATA[[channel-ID] [result] [kv-pair] [hash]]]></screen><glosslist><glossentry><glossterm>channel-ID</glossterm><glossdef><itemizedlist><listitem override="none"><para>When a concurrency <emphasis role="strong">channel-ID</emphasis> is received it must be sent back to Squid unchanged as the first entry on the line. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>result</glossterm><glossdef><itemizedlist><listitem override="none"><para>One of the result codes: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> OK </para></entry><entry colsep="1" rowsep="1"><para> Success. Valid credentials. Digest HA1 value is presented. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> ERR </para></entry><entry colsep="1" rowsep="1"><para> Success. Invalid credentials. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> BH </para></entry><entry colsep="1" rowsep="1"><para> Failure. The helper encountered a problem. </para></entry></row></tbody></tgroup></informaltable></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> the <emphasis role="strong">OK</emphasis> and <emphasis role="strong">BH</emphasis> result codes are only accepted by <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.4#">Squid-3.4</ulink> and newer.</para></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> for <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.3#">Squid-3.3</ulink> and older the <emphasis role="strong">OK</emphasis> result is not sent, but hash field is. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>kv-pair</glossterm><glossdef><itemizedlist><listitem override="none"><para>One or more key=value pairs. The key names reserved on this interface: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> clt_conn_tag=... </para></entry><entry colsep="1" rowsep="1"><para> Tag the client TCP connection (<ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.5#">Squid-3.5</ulink>) </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> group=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> ha1=... </para></entry><entry colsep="1" rowsep="1"><para> The digest HA1 value to be used. This field is only used on <emphasis role="strong">OK</emphasis> responses. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> message=... </para></entry><entry colsep="1" rowsep="1"><para> A message string that Squid can display on an error page. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> tag=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> ttl=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> *_=... </para></entry><entry colsep="1" rowsep="1"><para> Key names ending in (_) are reserved for local administrators use. </para></entry></row></tbody></tgroup></informaltable></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> the kv-pair field is only accepted by <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.4#">Squid-3.4</ulink> and newer. </para></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> the kv-pair returned by this helper can be logged by the <emphasis role="strong">%note</emphasis> <ulink url="http://www.squid-cache.org/Doc/config/logformat#">logformat</ulink> code. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>hash</glossterm><glossdef><itemizedlist><listitem override="none"><para>The digest HA1 value to be used. This field is only accepted on <emphasis role="strong">OK</emphasis> responses.</para><para> <inlinemediaobject><imageobject><imagedata depth="15" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/alert.png" width="15"/></imageobject><textobject><phrase>/!\</phrase></textobject></inlinemediaobject> This field is deprecated on Squid-3.4 and newer, use the <emphasis role="strong">ha1</emphasis> kv-pair instead. </para></listitem></itemizedlist></glossdef></glossentry></glosslist></section><section><title>Negotiate and NTLM Scheme</title><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> These authenticator schemes do not support concurrency due to the statefulness of NTLM. </para></listitem></itemizedlist><para>Input line received from Squid: </para><screen><![CDATA[ request [credentials] [key-extras]]]></screen><glosslist><glossentry><glossterm>request</glossterm><glossdef><itemizedlist><listitem override="none"><para>One of the request codes: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> YR </para></entry><entry colsep="1" rowsep="1"><para> A new challenge token is needed. This is always the first communication between the two processes. It may also occur at any time that Squid needs a new challenge, due to the <ulink url="http://www.squid-cache.org/Doc/config/auth_param#">auth_param</ulink> max_challenge_lifetime and max_challenge_uses parameters. The helper should respond with a <emphasis role="strong">TT</emphasis> message. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> KK </para></entry><entry colsep="1" rowsep="1"><para> Authenticate a user's credentials. The helper responds with either <emphasis role="strong">OK</emphasis>, <emphasis role="strong">ERR</emphasis>, <emphasis role="strong">AF</emphasis>, <emphasis role="strong">NA</emphasis>, or <emphasis role="strong">BH</emphasis>. </para></entry></row></tbody></tgroup></informaltable></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>credentials</glossterm><glossdef><itemizedlist><listitem override="none"><para>An encoded blob exactly as received in the HTTP headers. This field is only sent on <emphasis role="strong">KK</emphasis> requests. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>key-extras</glossterm><glossdef><itemizedlist><listitem override="none"><para>Additional parameters passed to the helper which may be configured with <ulink url="http://www.squid-cache.org/Doc/config/auth_param#">auth_param</ulink> <emphasis>key_extras</emphasis> parameter. Only available in <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.5#">Squid-3.5</ulink> and later. </para></listitem></itemizedlist></glossdef></glossentry></glosslist><para>Result line sent back to Squid: </para><screen><![CDATA[ result [token label] [kv-pair] [message]]]></screen><glosslist><glossentry><glossterm>result</glossterm><glossdef><itemizedlist><listitem override="none"><para>One of the result codes: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> TT </para></entry><entry colsep="1" rowsep="1"><para> Success. A new challenge <emphasis role="strong">token</emphasis> value is presented. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> AF </para></entry><entry colsep="1" rowsep="1"><para> Success. Valid credentials. Deprecated by <emphasis role="strong">OK</emphasis> result from Squid-3.4 onwards. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> NA </para></entry><entry colsep="1" rowsep="1"><para> Success. Invalid credentials. Deprecated by <emphasis role="strong">ERR</emphasis> result from Squid-3.4 onwards. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> OK </para></entry><entry colsep="1" rowsep="1"><para> Success. Valid Credentials. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> ERR </para></entry><entry colsep="1" rowsep="1"><para> Success. Invalid credentials. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> BH </para></entry><entry colsep="1" rowsep="1"><para> Failure. The helper encountered a problem. </para></entry></row></tbody></tgroup></informaltable></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> the <emphasis role="strong">OK</emphasis> and <emphasis role="strong">ERR</emphasis> result codes are only accepted by <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.4#">Squid-3.4</ulink> and newer. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>token</glossterm><glossdef><itemizedlist><listitem override="none"><para>A new challenge <emphasis role="strong">token</emphasis> value is presented. The token is base64-encoded, as defined by RFC <ulink url="https://tools.ietf.org/rfc/rfc2045#">2045</ulink>.</para><para> <inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> NOTE: NTLM authenticator interface on Squid-3.3 and older does not support a <emphasis role="strong">token</emphasis> field. Negotiate authenticator interface requires it on <emphasis role="strong">TT</emphasis>, <emphasis role="strong">AF</emphasis> and <emphasis role="strong">NA</emphasis> responses.</para><para> <inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> This field must not be sent on <emphasis role="strong">OK</emphasis>, <emphasis role="strong">ERR</emphasis> and <emphasis role="strong">BH</emphasis> responses. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>label</glossterm><glossdef><itemizedlist><listitem override="none"><para>The label given here is what gets used by Squid for this client request <emphasis role="strong">&quot;username&quot;</emphasis>. This field is only accepted on <emphasis role="strong">AF</emphasis> responses. It must not be sent on any other result code response. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>kv-pair</glossterm><glossdef><itemizedlist><listitem override="none"><para>One or more key=value pairs. The key names reserved on this interface: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> clt_conn_tag=... </para></entry><entry colsep="1" rowsep="1"><para> Tag the client TCP connection (<ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.5#">Squid-3.5</ulink>) </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> group=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> message=... </para></entry><entry colsep="1" rowsep="1"><para> A message string that Squid can display on an error page. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> tag=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> token=... </para></entry><entry colsep="1" rowsep="1"><para> The base64-encoded, as defined by RFC <ulink url="https://tools.ietf.org/rfc/rfc2045#">2045</ulink>, token to be used. This field is only used on <emphasis role="strong">OK</emphasis> responses. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> ttl=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> user=... </para></entry><entry colsep="1" rowsep="1"><para> The label to be used by Squid for this client request as <emphasis role="strong">&quot;username&quot;</emphasis>. With Negotiate and NTLM protocols it typically has the format NAME@DOMAIN or NAME\\DOMAIN respectively. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> *_=... </para></entry><entry colsep="1" rowsep="1"><para> Key names ending in (_) are reserved for local administrators use. </para></entry></row></tbody></tgroup></informaltable></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> the kv-pair field is only accepted by <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.4#">Squid-3.4</ulink> and newer. </para></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> the kv-pair returned by this helper can be logged by the <emphasis role="strong">%note</emphasis> <ulink url="http://www.squid-cache.org/Doc/config/logformat#">logformat</ulink> code. </para></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="15" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/alert.png" width="15"/></imageobject><textobject><phrase>/!\</phrase></textobject></inlinemediaobject> This field is only accepted on <emphasis role="strong">OK</emphasis>, <emphasis role="strong">ERR</emphasis> and <emphasis role="strong">BH</emphasis> responses and must not be sent on other responses. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>message</glossterm><glossdef><itemizedlist><listitem override="none"><para>A message string that Squid can display on an error page. This field is only accepted on <emphasis role="strong">NA</emphasis> and <emphasis role="strong">BH</emphasis> responses. From <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.4#">Squid-3.4</ulink> this field is deprecated by the <emphasis role="strong">message=</emphasis> kv-pair on <emphasis role="strong">BH</emphasis> responses. </para></listitem></itemizedlist></glossdef></glossentry></glosslist></section></section><section><title>Access Control (ACL)</title><para>This interface has a very flexible field layout. The administrator may configure any number or order of details from the relevant HTTP request or reply to be sent to the helper. </para><para>Input line received from Squid: </para><screen><![CDATA[[channel-ID] format-options [acl-value [acl-value ...]]]]></screen><glosslist><glossentry><glossterm>channel-ID</glossterm><glossdef><itemizedlist><listitem override="none"><para>This is an ID for the line when concurrency is enabled. When concurrency is turned off (<emphasis role="strong">concurrency=1</emphasis>) in <ulink url="http://www.squid-cache.org/Doc/config/external_acl_type#">external_acl_type</ulink> this field and the following space will be completely missing. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>format-options</glossterm><glossdef><itemizedlist><listitem override="none"><para>This is the flexible series of tokens configured as the <emphasis role="strong">FORMAT</emphasis> area of <ulink url="http://www.squid-cache.org/Doc/config/external_acl_type#">external_acl_type</ulink>. The tokens are space-delimited and exactly match the order of <emphasis role="strong">%</emphasis> tokens in the configured <emphasis role="strong">FORMAT</emphasis>. By default in current releases these tokens are also URL-encoded according to RFC <ulink url="https://tools.ietf.org/rfc/rfc1738#">1738</ulink> to protect against whitespace and binary data problems. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>acl-value</glossterm><glossdef><itemizedlist><listitem override="none"><para>Some ACL tests such as group name comparisons pass their test values to the external helper following the admin configured FORMAT. Depending on the ACL these may be sent one value at a time, as a list of values, or nothing may be sent. By default in current releases these tokens are also URL-encoded according to RFC <ulink url="https://tools.ietf.org/rfc/rfc1738#">1738</ulink> to protect against whitespace and binary data problems. </para><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="15" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/alert.png" width="15"/></imageobject><textobject><phrase>/!\</phrase></textobject></inlinemediaobject> In <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-4#">Squid-4</ulink> these acl-value expand to a dash ('-') if there is no %DATA macro used in the format-options. In older Squid this would have expanded to whitespace. </para></listitem></itemizedlist></listitem></itemizedlist></glossdef></glossentry></glosslist><para>Result line sent back to Squid: </para><screen><![CDATA[[channel-ID] result [kv-pair]]]></screen><glosslist><glossentry><glossterm>channel-ID</glossterm><glossdef><itemizedlist><listitem override="none"><para>When a concurrency <emphasis role="strong">channel-ID</emphasis> is received it must be sent back to Squid unchanged as the first entry on the line. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>result</glossterm><glossdef><itemizedlist><listitem override="none"><para>One of the result codes: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> OK </para></entry><entry colsep="1" rowsep="1"><para> Success. ACL test matches. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> ERR </para></entry><entry colsep="1" rowsep="1"><para> Success. ACL test fails to match. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> BH </para></entry><entry colsep="1" rowsep="1"><para> Failure. The helper encountered a problem. </para></entry></row></tbody></tgroup></informaltable></listitem><listitem override="none"><para>The configured usage of the external ACL in squid.conf determines what this result means.</para></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> the <emphasis role="strong">BH</emphasis> result code is only accepted by <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.4#">Squid-3.4</ulink> and newer. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>kv-pair</glossterm><glossdef><itemizedlist><listitem override="none"><para>One or more key=value pairs. see <ulink url="http://www.squid-cache.org/Doc/config/external_acl_type#">external_acl_type</ulink> for the full list supported by your Squid. The key names reserved on this interface: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> clt_conn_tag=... </para></entry><entry colsep="1" rowsep="1"><para> Tag the client TCP connection (<ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.5#">Squid-3.5</ulink>) </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> group=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> log=... </para></entry><entry colsep="1" rowsep="1"><para> String to be logged in access.log. Available as <emphasis role="strong">%ea</emphasis> in <ulink url="http://www.squid-cache.org/Doc/config/logformat#">logformat</ulink> specifications </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> message=... </para></entry><entry colsep="1" rowsep="1"><para> Message describing the reason. Available as %o in error pages </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> password=... </para></entry><entry colsep="1" rowsep="1"><para> The users password (for login= <ulink url="http://www.squid-cache.org/Doc/config/cache_peer#">cache_peer</ulink> option) </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> tag=... </para></entry><entry colsep="1" rowsep="1"><para> Apply a tag to a request (for both <emphasis role="strong">ERR</emphasis> and <emphasis role="strong">OK</emphasis> results). Only sets a tag, does not alter existing tags. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> ttl=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> user=... </para></entry><entry colsep="1" rowsep="1"><para> The users name (login) </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> *_=... </para></entry><entry colsep="1" rowsep="1"><para> Key names ending in (_) are reserved for local administrators use. </para></entry></row></tbody></tgroup></informaltable></listitem></itemizedlist></glossdef></glossentry></glosslist></section><section><title>Logging</title><para>Squid sends a number of commands to the log daemon. These are sent in the first byte of each input line: </para><itemizedlist><listitem override="none"><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> L&lt;data&gt;\n </para></entry><entry colsep="1" rowsep="1"><para> logfile data </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> R\n </para></entry><entry colsep="1" rowsep="1"><para> rotate file </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> T\n </para></entry><entry colsep="1" rowsep="1"><para> truncate file </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> O\n </para></entry><entry colsep="1" rowsep="1"><para> re-open file </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> F\n </para></entry><entry colsep="1" rowsep="1"><para> flush file </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> r&lt;n&gt;\n </para></entry><entry colsep="1" rowsep="1"><para> set rotate count to &lt;n&gt; </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> b&lt;n&gt;\n </para></entry><entry colsep="1" rowsep="1"><para> 1 = buffer output, 0 = don't buffer output </para></entry></row></tbody></tgroup></informaltable></listitem></itemizedlist><para>No response is expected. Any response that may be desired should occur on stderr to be viewed through cache.log. </para></section><section><title>SSL certificate generation</title><para>This interface has a fixed field layout. </para><para>Input <emphasis>line</emphasis> received from Squid: </para><screen><![CDATA[request size kv-pairs [body]]]></screen><para><inlinemediaobject><imageobject><imagedata depth="15" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/alert.png" width="15"/></imageobject><textobject><phrase>/!\</phrase></textobject></inlinemediaobject> <emphasis>line</emphasis> refers to a logical input. <emphasis role="strong">body</emphasis> may contain \n characters so each line in this format is delimited by a 0x01 byte instead of the standard \n byte. </para><glosslist><glossentry><glossterm>request</glossterm><glossdef><itemizedlist><listitem override="none"><para>The type of action being requested. Presently the code <emphasis role="strong">new_certificate</emphasis> is the only request made. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>size</glossterm><glossdef><itemizedlist><listitem override="none"><para>Total size of the following request bytes taken by the <emphasis role="strong">kv-pair</emphasis> parameters and <emphasis role="strong">body</emphasis>. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>kv-pair</glossterm><glossdef><itemizedlist><listitem override="none"><para>One or more key=value pairs separated by new lines. The key names reserved on this interface: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> host= </para></entry><entry colsep="1" rowsep="1"><para> FQDN host name of the domain needing a certificate. </para></entry></row></tbody></tgroup></informaltable></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>body</glossterm><glossdef><itemizedlist><listitem override="none"><para>An optional CA certificate and private RSA key to sign with. If this body field is omitted the generated certificate will be self-signed. The content of this field is ASCII-armoured PEM format. </para><screen><![CDATA[-----BEGIN CERTIFICATE-----
...
-----END CERTIFICATE-----
-----BEGIN RSA PRIVATE KEY-----
...
-----END RSA PRIVATE KEY-----]]></screen></listitem></itemizedlist></glossdef></glossentry></glosslist><para>Result line sent back to Squid: </para><screen><![CDATA[result size [kv-pairs] body]]></screen><glosslist><glossentry><glossterm>result</glossterm><glossdef><itemizedlist><listitem override="none"><para>One of the result codes: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> OK </para></entry><entry colsep="1" rowsep="1"><para> Success. A certificate is ready </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> BH </para></entry><entry colsep="1" rowsep="1"><para> Failure. The helper encountered a problem. </para></entry></row></tbody></tgroup></informaltable></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> the <emphasis role="strong">OK</emphasis> and <emphasis role="strong">BH</emphasis> result codes are only accepted by <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.3#">Squid-3.3</ulink> and newer.</para></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="15" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/alert.png" width="15"/></imageobject><textobject><phrase>/!\</phrase></textobject></inlinemediaobject> The helper will display an error message and abort if any error or unexpected event is detected. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>size</glossterm><glossdef><itemizedlist><listitem override="none"><para>Total size of the following request bytes taken by the <emphasis role="strong">body</emphasis>. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>kv-pairs</glossterm><glossdef><itemizedlist><listitem override="none"><para>An optional list of key=value parameters separated by new lines. Some of the supported key=value pairs are: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> host= </para></entry><entry colsep="1" rowsep="1"><para> FQDN host name of the domain this certificate is for. </para></entry></row></tbody></tgroup></informaltable></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>body</glossterm><glossdef><itemizedlist><listitem override="none"><para>The generated CA certificate. The content of this field is ASCII-armoured PEM format. </para><screen><![CDATA[-----BEGIN CERTIFICATE-----
...
-----END CERTIFICATE-----]]></screen></listitem></itemizedlist></glossdef></glossentry></glosslist></section><section><title>SSL server certificate validator</title><para>This interface is similar to the SSL certificate generation interface. </para><para>Input <emphasis>line</emphasis> received from Squid: </para><screen><![CDATA[request size [kv-pairs]]]></screen><para><inlinemediaobject><imageobject><imagedata depth="15" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/alert.png" width="15"/></imageobject><textobject><phrase>/!\</phrase></textobject></inlinemediaobject> <emphasis>line</emphasis> refers to a logical input. <emphasis role="strong">body</emphasis> may contain \n characters so each line in this format is delimited by a 0x01 byte instead of the standard \n byte. </para><glosslist><glossentry><glossterm>request</glossterm><glossdef><itemizedlist><listitem override="none"><para>The type of action being requested. Presently the code <emphasis role="strong">cert_validate</emphasis> is the only request made. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>size</glossterm><glossdef><itemizedlist><listitem override="none"><para>Total size of the following request bytes taken by the <emphasis role="strong">key=pair</emphasis> parameters. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>kv-pairs</glossterm><glossdef><itemizedlist><listitem override="none"><para>An optional list of key=value parameters separated by new lines. Supported parameters are: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> host </para></entry><entry colsep="1" rowsep="1"><para> FQDN host name or the domain </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> proto_version </para></entry><entry colsep="1" rowsep="1"><para> The SSL/TLS version </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> cipher </para></entry><entry colsep="1" rowsep="1"><para> The SSL/TLS cipher being used </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> cert_<emphasis><emphasis role="strong">ID</emphasis></emphasis> </para></entry><entry colsep="1" rowsep="1"><para> Server certificate. The ID is an index number for this certificate. This parameter exist as many as the server certificates are</para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> error_name_<emphasis><emphasis role="strong">ID</emphasis></emphasis> </para></entry><entry colsep="1" rowsep="1"><para> The openSSL certificate validation error. The ID is an index number for this error </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> error_cert_<emphasis><emphasis role="strong">ID</emphasis></emphasis> </para></entry><entry colsep="1" rowsep="1"><para> The ID of the certificate which caused error_name_ID </para></entry></row></tbody></tgroup></informaltable></listitem></itemizedlist></glossdef></glossentry></glosslist><para>Example request: </para><screen><![CDATA[0 cert_validate 1519 host=dmz.example-domain.com
cert_0=-----BEGIN CERTIFICATE-----
MIID+DCCA2GgAwIBAgIJAIDcHRUxB2O4MA0GCSqGSIb3DQEBBAUAMIGvMQswCQYD
...
YpVJGt5CJuNfCcB/
-----END CERTIFICATE-----
error_name_0=X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT
error_cert_0=cert0]]></screen><para>Result line sent back to Squid: </para><screen><![CDATA[result size kv-pairs]]></screen><glosslist><glossentry><glossterm>result</glossterm><glossdef><itemizedlist><listitem override="none"><para>One of the result codes: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> OK </para></entry><entry colsep="1" rowsep="1"><para> Success. Certificate validated. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> ERR </para></entry><entry colsep="1" rowsep="1"><para> Success. Certificate not validated. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> BH </para></entry><entry colsep="1" rowsep="1"><para> Failure. The helper encountered a problem. </para></entry></row></tbody></tgroup></informaltable></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>size</glossterm><glossdef><itemizedlist><listitem override="none"><para>Total size of the following response bytes taken by the <emphasis role="strong">key=pair</emphasis> parameters. </para></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>kv-pairs</glossterm><glossdef><itemizedlist><listitem override="none"><para>A list of key=value parameters separated by new lines. The supported parameters are: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> cert_<emphasis><emphasis role="strong">ID</emphasis></emphasis> </para></entry><entry colsep="1" rowsep="1"><para> A certificate send from helper to squid. The <emphasis role="strong">ID</emphasis> is an index number for this certificate </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> error_name_<emphasis><emphasis role="strong">ID</emphasis></emphasis> </para></entry><entry colsep="1" rowsep="1"><para> The openSSL error name for the error <emphasis role="strong">ID</emphasis> </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> error_reason_<emphasis><emphasis role="strong">ID</emphasis></emphasis></para></entry><entry colsep="1" rowsep="1"><para> A reason for the error <emphasis role="strong">ID</emphasis></para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> error_cert_<emphasis><emphasis role="strong">ID</emphasis></emphasis> </para></entry><entry colsep="1" rowsep="1"><para> The broken certificate. It can be one of the certificates sent by helper to squid or one of those sent by squid to helper</para></entry></row></tbody></tgroup></informaltable></listitem></itemizedlist></glossdef></glossentry></glosslist><para>Example response message: </para><screen><![CDATA[ERR 1444 cert_10=-----BEGIN CERTIFICATE-----
MIIDojCCAoqgAwIBAgIQE4Y1TR0/BvLB+WUF1ZAcYjANBgkqhkiG9w0BAQUFADBr
...
398znM/jra6O1I7mT1GvFpLgXPYHDw==
-----END CERTIFICATE-----
error_name_0=X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT
error_reason_0=Checked by Cert Validator
error_cert_0=cert_10]]></screen></section><section><title>Cache file eraser</title><para>The unlink() function used to erase files is a blocking call and can slow Squid down. This interface is used to pass file erase instructions to a helper program specified by <ulink url="http://www.squid-cache.org/Doc/config/unlinkd_program#">unlinkd_program</ulink>. </para><para>This interface has a fixed field layout. As of <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/Squid-3.3#">Squid-3.3</ulink> this interface does not support concurrency. It requires Squid to be built with <emphasis role="strong">--enable-unlinkd</emphasis> and only cache storage types which use disk files (UFS, AUFS, diskd) use this interface. </para><para>Input line received from Squid: </para><screen><![CDATA[path]]></screen><glosslist><glossentry><glossterm>path</glossterm><glossdef><itemizedlist><listitem override="none"><para>The file to be erased. </para></listitem></itemizedlist></glossdef></glossentry></glosslist><para>Result line sent back to Squid: </para><screen><![CDATA[result [kv-pair]]]></screen><glosslist><glossentry><glossterm>result</glossterm><glossdef><itemizedlist><listitem override="none"><para>One of the result codes: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> OK </para></entry><entry colsep="1" rowsep="1"><para> Success. The file has been removed from cache. </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> BH </para></entry><entry colsep="1" rowsep="1"><para> Failure. The helper encountered a problem. </para></entry></row></tbody></tgroup></informaltable></listitem></itemizedlist></glossdef></glossentry><glossentry><glossterm>kv-pair</glossterm><glossdef><itemizedlist><listitem override="none"><para>One or more key=value pairs. The key names reserved on this interface: </para><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para> clt_conn_tag=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> message=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> tag=... </para></entry><entry colsep="1" rowsep="1"><para> reserved </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para> *_=... </para></entry><entry colsep="1" rowsep="1"><para> Key names ending in (_) are reserved for local administrators use. </para></entry></row></tbody></tgroup></informaltable></listitem></itemizedlist></glossdef></glossentry></glosslist><!--rule (<hr>) is not applicable to DocBook--><para> <ulink url="https://wiki.squid-cache.org/Features/AddonHelpers/CategoryFeature#">CategoryFeature</ulink> </para></section></section></section></article>