<?xml version="1.0" encoding="utf-8"?><!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>ConfigExamples/Authenticate/LoggingOnly</title><revhistory><revision><revnumber>8</revnumber><date>2021-07-02 14:43:09</date><authorinitials>FrancescoChemolli</authorinitials></revision><revision><revnumber>7</revnumber><date>2020-06-11 16:29:24</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>6</revnumber><date>2020-06-11 16:28:34</date><authorinitials>AmosJeffries</authorinitials><revremark>fake helpers have been bundled with Squid for a long time.</revremark></revision><revision><revnumber>5</revnumber><date>2009-02-04 07:18:08</date><authorinitials>AmosJeffries</authorinitials><revremark>auth demo</revremark></revision><revision><revnumber>4</revnumber><date>2009-02-04 07:17:14</date><authorinitials>AmosJeffries</authorinitials><revremark>v2</revremark></revision><revision><revnumber>3</revnumber><date>2009-02-04 07:07:14</date><authorinitials>AmosJeffries</authorinitials><revremark>mention fakeauth, and proper silent auth hack</revremark></revision><revision><revnumber>2</revnumber><date>2008-05-18 19:38:56</date><authorinitials>localhost</authorinitials><revremark>converted to 1.6 markup</revremark></revision><revision><revnumber>1</revnumber><date>2008-03-27 02:59:38</date><authorinitials>TimBates</authorinitials></revision></revhistory></articleinfo><section><title>Logging usernames when using passthrough authentication</title><para><emphasis role="strong">Warning</emphasis>: Any example presented here is provided &quot;as-is&quot; with no support or guarantee of suitability. If you have any further questions about these examples please email the squid-users mailing list. </para><section><title>Outline</title><para>Squid can log usernames for each request made. But it will only do this if an ACL demands authentication and an authentication method is configured. If an upstream proxy requires authentication, and you require username logging, chances are you will not have access to the upstream password database (or you could probably just check the logs there instead). </para></section><section><title>Silent Authentication Demand</title><para>To make squid 'demand' authentication details for logging this small hack needs to be used: </para><screen><![CDATA[acl dummyAuth proxy_auth REQUIRED
http_access deny !dummyAuth all]]></screen><para>Remember that http_access order is very important. If you allow access without the &quot;dummyAuth&quot; acl, you won't get usernames logged. </para><para>One of the following authentication helpers is also needed to ensure that login details are available for use when that demand is made. </para></section><section><title>Basic Authentication</title><para>Squid provides a helper <emphasis role="strong">basic_fake_auth</emphasis> to do the authentication challenges needed. It simply does NO authentication, and replies <emphasis role="strong">OK</emphasis> to any username/password combination. </para><section><title>Squid Configuration File</title><para>This section defines the authentication helper and related settings. </para><screen><![CDATA[auth_param basic program /usr/lib/squid/basic_fake_auth
auth_param basic children 10
auth_param basic credentialsttl 1 hours
auth_param basic casesensitive off]]></screen></section></section><section><title>NTLM Authentication</title><para>Squid provides a helper <emphasis role="strong">ntlm_fake_auth</emphasis> to do the NTLM handshake and authentication challenges needed. The helper always returns <emphasis role="strong">OK</emphasis> whatever the result. </para><section><title>Squid Configuration File</title><screen><![CDATA[auth_param ntlm program /usr/lib/squid/ntlm_fake_auth
auth_param ntlm children 10]]></screen><!--rule (<hr>) is not applicable to DocBook--><para> <ulink url="https://wiki.squid-cache.org/ConfigExamples/Authenticate/LoggingOnly/CategoryConfigExample#">CategoryConfigExample</ulink> </para></section></section></section></article>