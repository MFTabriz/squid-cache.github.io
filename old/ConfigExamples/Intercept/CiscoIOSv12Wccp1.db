<?xml version="1.0" encoding="utf-8"?><!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>ConfigExamples/Intercept/CiscoIOSv12Wccp1</title><revhistory><revision><revnumber>4</revnumber><date>2009-10-19 23:03:45</date><authorinitials>AmosJeffries</authorinitials><revremark>easier regex on feature page include</revremark></revision><revision><revnumber>3</revnumber><date>2009-10-19 23:03:28</date><authorinitials>AmosJeffries</authorinitials><revremark>meta tags for feature page include</revremark></revision><revision><revnumber>2</revnumber><date>2009-06-18 11:55:18</date><authorinitials>AmosJeffries</authorinitials><revremark>tweak a bit.</revremark></revision><revision><revnumber>1</revnumber><date>2009-06-18 11:52:00</date><authorinitials>AmosJeffries</authorinitials><revremark>import from FAQ</revremark></revision></revhistory></articleinfo><section><title>Configuring Cisco IOS 12.x for WCCP Interception</title><para><emphasis role="strong">Warning</emphasis>: Any example presented here is provided &quot;as-is&quot; with no support or guarantee of suitability. If you have any further questions about these examples please email the squid-users mailing list. </para><section><title>Outline</title></section><section><title>Cisco IOS 12.x router</title><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="15" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/alert.png" width="15"/></imageobject><textobject><phrase>/!\</phrase></textobject></inlinemediaobject> Some of the early versions of 12.x do not have the 'ip wccp version' command. You will need to upgrade your IOS version to use V1.0. </para></listitem></itemizedlist><screen><![CDATA[conf t
ip wccp version 1
ip wccp web-cache redirect-list 150
!
interface [Interface carrying Outgoing/Incoming Traffic]x/x
ip wccp web-cache redirect out|in
!
CTRL Z
copy running-config startup-config]]></screen><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-error.png" width="16"/></imageobject><textobject><phrase>{X}</phrase></textobject></inlinemediaobject> IOS defaults to using WCCP version 2 if you do not explicitly specify a version. </para></listitem></itemizedlist><para>Replace 150 with an access list number (either standard or extended)  which lists IP addresses which you do not wish to be transparently redirected to your cache. </para><para>If you wish to redirect all client traffic then remove the: </para><screen><![CDATA[ip wccp web-cache redirect-list]]></screen><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="15" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/idea.png" width="15"/></imageobject><textobject><phrase>(!)</phrase></textobject></inlinemediaobject> WCCP is smart enough that it will automatically bypass your cache from the redirection process, ensuring that your cache does not become redirected back to itself. </para></listitem></itemizedlist></section><section><title>Troubleshooting</title><para>Some people report problems with WCCPv1 and IOS 12.x. </para><section><title>Redirection not working properly</title><para>Try turning off CEF and disabling the route-cache on the interface.  WCCP has a nasty habit of sometimes badly interacting with some other cisco features.  Note that both features result in quite significant performance penalties, so only disable them if there is no other way. </para><para>IOS firewall inspection can also cause problems with WCCP and is worth disabling if you experience problems. </para><!--rule (<hr>) is not applicable to DocBook--><para> <ulink url="https://wiki.squid-cache.org/ConfigExamples/Intercept/CiscoIOSv12Wccp1/CategoryConfigExample#">CategoryConfigExample</ulink> </para></section></section></section></article>