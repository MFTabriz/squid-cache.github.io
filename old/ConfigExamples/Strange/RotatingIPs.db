<?xml version="1.0" encoding="utf-8"?><!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>ConfigExamples/Strange/RotatingIPs</title><revhistory><revision><revnumber>1</revnumber><date>2009-10-13 23:33:22</date><authorinitials>AmosJeffries</authorinitials><revremark>create from squid-users thread.</revremark></revision></revhistory></articleinfo><section><title>Rotating the Squid outbound IPs</title><para><emphasis role="strong">Warning</emphasis>: Any example presented here is provided &quot;as-is&quot; with no support or guarantee of suitability. If you have any further questions about these examples please email the squid-users mailing list. </para><para>This is a section for weird (and sometimes wonderful) configurations Squid is capable of. Clued in admin often find no actual useful benefits from going to this much trouble, but well, people seems to occasionally ask for them... </para><section><title>Outline</title><para>Write some introduction here. </para></section><section><title>Real: Load balancing</title><para>When squid is faced with multiple outbound links and needs to load-balance between them this can have some utility. It should be noted however that proper configuration of the routing tables for those links will be of much greater benefit and catch non-Squid traffic in the load balancing as well. </para><section><title>Example: Splitting uploads and downloads between two ISP links</title><screen><![CDATA[acl download method GET HEAD
acl upload method POST PUT
]]><![CDATA[
# IP used by link for downloads
tcp_outgoing_address 192.0.2.1 download
]]><![CDATA[
# IP used by link for uploads
tcp_outgoing_address 192.0.2.2 upload]]></screen></section></section><section><title>Weird: So-called privacy</title><para>I assume that some requesters have heard about an IPv6 <emphasis>privacy address</emphasis> RFC that popped up some time ago and want to do this for IPv4 as well via Squid. </para><para>Points to Note: </para><itemizedlist><listitem><para>the real meaning of the word <emphasis>privacy</emphasis> has nothing in common with IP addresses. Which are by definition, purpose, and usage the <emphasis role="strong">public</emphasis> identifiers of a machine. There are real private IPs. If you want privacy use them. </para></listitem><listitem><para>there is no actual benefit from using such address mangling in a controlled network. Use DHCP instead. Maybe also NAT. </para></listitem><listitem><para>the use of the RFC address manipulation only works over private ISP connections. Such as dialup or DSL broadband links. Where some form of frame-level authentication is done for user tracking instead of IP tracking. </para></listitem><listitem><para>any network running privacy addresses is required to turn off all useful firewall controls. </para></listitem></itemizedlist><section><title>Example: Rotating three IPs based on time of day</title><screen><![CDATA[acl morning time 06:00-11:59
acl afternoon time 12:00-18:00
acl night time 18:00-06:00
]]><![CDATA[
# IP used in the morning
tcp_outgoing_address 192.0.2.1 morning
]]><![CDATA[
# IP used in the afternoon
tcp_outgoing_address 192.0.2.2 afternoon
]]><![CDATA[
# IP used in the night
tcp_outgoing_address 192.0.2.3 night]]></screen><!--rule (<hr>) is not applicable to DocBook--><para> <ulink url="https://wiki.squid-cache.org/ConfigExamples/Strange/RotatingIPs/CategoryConfigExample#">CategoryConfigExample</ulink> </para></section></section></section></article>