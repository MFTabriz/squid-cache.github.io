<?xml version="1.0" encoding="utf-8"?><!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>ConfigExamples/Chat/Whatsapp</title><revhistory><revision><revnumber>7</revnumber><date>2021-07-03 09:51:08</date><authorinitials>FrancescoChemolli</authorinitials></revision><revision><revnumber>6</revnumber><date>2018-04-06 21:06:13</date><authorinitials>YuriVoinov</authorinitials></revision><revision><revnumber>5</revnumber><date>2018-04-06 21:03:09</date><authorinitials>YuriVoinov</authorinitials></revision><revision><revnumber>4</revnumber><date>2018-04-06 21:02:26</date><authorinitials>YuriVoinov</authorinitials></revision><revision><revnumber>3</revnumber><date>2018-04-06 21:01:42</date><authorinitials>YuriVoinov</authorinitials></revision><revision><revnumber>2</revnumber><date>2018-04-06 21:01:11</date><authorinitials>YuriVoinov</authorinitials></revision><revision><revnumber>1</revnumber><date>2018-04-06 20:59:54</date><authorinitials>YuriVoinov</authorinitials></revision></revhistory></articleinfo><para><emphasis>by <ulink url="https://wiki.squid-cache.org/ConfigExamples/Chat/Whatsapp/YuriVoinov#">YuriVoinov</ulink></emphasis> </para><section><title>Whatsapp Messenger (mobile/web)</title><para><emphasis role="strong">Warning</emphasis>: Any example presented here is provided &quot;as-is&quot; with no support or guarantee of suitability. If you have any further questions about these examples please email the squid-users mailing list. </para><section><title>How to pass Whatsapp</title><para>Whatsapp is one of difficult-to-pass IM software. Two issues found: </para><orderedlist numeration="arabic"><listitem><para>Web whatsapp general connecting </para></listitem><listitem><para>Media files transfers for mobile Whatsapp application </para></listitem></orderedlist><para>First of all, Whatsapp requires SSL Bump-aware squid (no matter, bump all or splice all config). With splice all config, all Whatsapp apps should work without issues. </para><para>On the other hand, bump all config requires some additional steps to make both (web and mobile) Whatsapp applications work. </para></section><section><title>Squid Configuration File</title><para>First, let's assume you have SSL Bump configuration like this: </para><screen><![CDATA[# SSL bump rules
acl DiscoverSNIHost at_step SslBump1
acl NoSSLIntercept ssl::server_name_regex "/usr/local/squid/etc/acl.url.nobump"
ssl_bump peek DiscoverSNIHost
ssl_bump splice NoSSLIntercept
ssl_bump bump all]]></screen><para>To make Whatsapp works, add this to acl.url.nobump: </para><screen><![CDATA[# Web.whatsapp.com
(w[0-9]+|[a-z]+)\.web\.whatsapp\.com
# Whatsapp CDN issue
.whatsapp\.net]]></screen><para>That's all. Just reconfigure squid. </para><para>Don't forget to put proxy CA to mobile devices. </para><!--rule (<hr>) is not applicable to DocBook--><para> <ulink url="https://wiki.squid-cache.org/ConfigExamples/Chat/Whatsapp/CategoryConfigExample#">CategoryConfigExample</ulink> </para></section></section></article>