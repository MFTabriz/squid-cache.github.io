<?xml version="1.0" encoding="utf-8"?><!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>KnowledgeBase/CentOS</title><revhistory><revision><revnumber>39</revnumber><date>2020-01-09 10:10:54</date><authorinitials>Eliezer Croitoru</authorinitials></revision><revision><revnumber>38</revnumber><date>2019-06-11 21:00:00</date><authorinitials>Eliezer Croitoru</authorinitials><revremark>Fixed a typo.</revremark></revision><revision><revnumber>37</revnumber><date>2019-06-11 20:58:29</date><authorinitials>Eliezer Croitoru</authorinitials><revremark>Adding a repo mirror script and cern mirror url</revremark></revision><revision><revnumber>36</revnumber><date>2018-08-28 03:36:18</date><authorinitials>AmosJeffries</authorinitials><revremark>updates for current packaging condition</revremark></revision><revision><revnumber>35</revnumber><date>2017-09-25 18:40:48</date><authorinitials>Eliezer Croitoru</authorinitials><revremark>Updated beta latest version.</revremark></revision><revision><revnumber>34</revnumber><date>2017-04-25 15:49:58</date><authorinitials>Eliezer Croitoru</authorinitials></revision><revision><revnumber>33</revnumber><date>2017-01-27 16:02:06</date><authorinitials>AmosJeffries</authorinitials><revremark>as the comment says, dont change the layout, that includes the indenting. 4 = indents are required for the BinaryPackages page</revremark></revision><revision><revnumber>32</revnumber><date>2017-01-27 01:43:40</date><authorinitials>Eliezer Croitoru</authorinitials><revremark>For some reason something with the Title type (h4 instead of h3) in some sections</revremark></revision><revision><revnumber>31</revnumber><date>2017-01-27 01:41:28</date><authorinitials>Eliezer Croitoru</authorinitials><revremark>Fixed the header from 3 to 4</revremark></revision><revision><revnumber>30</revnumber><date>2017-01-27 01:32:29</date><authorinitials>Eliezer Croitoru</authorinitials><revremark>Added clarifiation</revremark></revision><revision><revnumber>29</revnumber><date>2017-01-27 01:32:00</date><authorinitials>Eliezer Croitoru</authorinitials></revision><revision><revnumber>28</revnumber><date>2017-01-22 00:37:35</date><authorinitials>Eliezer Croitoru</authorinitials><revremark>Update of the beta latest release</revremark></revision><revision><revnumber>27</revnumber><date>2016-06-14 01:24:09</date><authorinitials>Eliezer Croitoru</authorinitials><revremark>Updated the release state</revremark></revision><revision><revnumber>26</revnumber><date>2015-10-19 18:52:23</date><authorinitials>Eliezer Croitoru</authorinitials><revremark>Addition of Squid beta repository and couple typos fixes</revremark></revision><revision><revnumber>25</revnumber><date>2015-08-18 11:02:20</date><authorinitials>Eliezer Croitoru</authorinitials><revremark>Couple typos fix and changes in 3.5.7-2. + removal of some old notes since it's not a history or a captin log.</revremark></revision><revision><revnumber>24</revnumber><date>2015-08-17 23:55:29</date><authorinitials>Eliezer Croitoru</authorinitials><revremark>Fixed a typo</revremark></revision><revision><revnumber>23</revnumber><date>2015-08-17 23:54:12</date><authorinitials>Eliezer Croitoru</authorinitials><revremark>[X] 3.5.7 Stable</revremark></revision><revision><revnumber>22</revnumber><date>2015-07-14 13:43:16</date><authorinitials>Eliezer Croitoru</authorinitials></revision><revision><revnumber>21</revnumber><date>2015-07-14 13:42:32</date><authorinitials>Eliezer Croitoru</authorinitials><revremark>Fixing beta references related words.</revremark></revision><revision><revnumber>20</revnumber><date>2015-07-14 08:31:07</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>19</revnumber><date>2015-02-09 11:04:09</date><authorinitials>AmosJeffries</authorinitials><revremark>centos is now apparently providing 3.1 and 3.3 in their latest official versions. still no better info than distrowatch version tracking.</revremark></revision><revision><revnumber>18</revnumber><date>2015-01-25 00:23:19</date><authorinitials>Eliezer Croitoru</authorinitials></revision><revision><revnumber>17</revnumber><date>2014-11-18 21:35:48</date><authorinitials>Eliezer Croitoru</authorinitials><revremark>Addition of 3.5 beta and couple additions.</revremark></revision><revision><revnumber>16</revnumber><date>2014-09-20 20:12:04</date><authorinitials>Eliezer Croitoru</authorinitials></revision><revision><revnumber>15</revnumber><date>2014-09-20 20:03:12</date><authorinitials>Eliezer Croitoru</authorinitials><revremark>Fixing typos</revremark></revision><revision><revnumber>14</revnumber><date>2014-09-04 21:23:15</date><authorinitials>Eliezer Croitoru</authorinitials><revremark>Fixing the right url removing the &quot;beta&quot; part</revremark></revision><revision><revnumber>13</revnumber><date>2014-06-23 20:33:26</date><authorinitials>Eliezer Croitoru</authorinitials><revremark>removal of aus repo due to the change of www1 cache proxy on high bandwidht network.</revremark></revision><revision><revnumber>12</revnumber><date>2014-03-30 00:40:53</date><authorinitials>AmosJeffries</authorinitials><revremark>remove beta labelling on 3.4 series</revremark></revision><revision><revnumber>11</revnumber><date>2013-10-06 03:16:42</date><authorinitials>AmosJeffries</authorinitials><revremark>convert OpenSUSE mention in CentOS documentation to a subnote</revremark></revision><revision><revnumber>10</revnumber><date>2013-10-05 15:58:00</date><authorinitials>Eliezer Croitoru</authorinitials></revision><revision><revnumber>9</revnumber><date>2013-10-05 15:44:55</date><authorinitials>Eliezer Croitoru</authorinitials><revremark>typo fix</revremark></revision><revision><revnumber>8</revnumber><date>2013-10-05 15:39:08</date><authorinitials>Eliezer Croitoru</authorinitials></revision><revision><revnumber>7</revnumber><date>2013-09-29 20:29:51</date><authorinitials>Eliezer Croitoru</authorinitials></revision><revision><revnumber>6</revnumber><date>2013-09-02 20:38:39</date><authorinitials>Eliezer Croitoru</authorinitials></revision><revision><revnumber>5</revnumber><date>2013-07-28 15:49:18</date><authorinitials>Eliezer Croitoru</authorinitials></revision><revision><revnumber>4</revnumber><date>2013-07-27 18:32:59</date><authorinitials>Eliezer Croitoru</authorinitials></revision><revision><revnumber>3</revnumber><date>2013-05-22 10:41:06</date><authorinitials>AmosJeffries</authorinitials><revremark>Eliezer is providing 3.3 bundles for CentOS</revremark></revision><revision><revnumber>2</revnumber><date>2011-05-10 11:21:12</date><authorinitials>AmosJeffries</authorinitials><revremark>better bugs link</revremark></revision><revision><revnumber>1</revnumber><date>2011-05-10 11:15:05</date><authorinitials>AmosJeffries</authorinitials><revremark>create</revremark></revision></revhistory></articleinfo><section><title>Squid on CentOS</title><section><title>Pre-Built Binary Packages</title><para>Squid bundles with CentOS. However there is apparently no publicly available information about where to find the packages or who is bundling them. EPEL, DAG and RPMforge repositories appear to no longer contain any files. Other sources imply that CentOS is an alias for RHEL (we know otherwise). Although, yes, the RHEL packages should work on CentOS. </para><para><emphasis role="strong">Maintainer:</emphasis> unknown </para><para><emphasis role="strong">Bug Reporting:</emphasis> <ulink url="http://bugs.centos.org/search.php?category=squid&amp;sortby=last_updated&amp;hide_status_id=-2"/> </para><para><emphasis role="strong">Eliezer</emphasis>: 25/Apr/2017 - I have tested CentOS 7 RPMs for squid 3.5.25 on a small scale and it seems to be stable enough for 200-300 users as a forward proxy and basic features. </para><section><title>NgTech CentOS/Fedora Copr hosted Repository</title><para><ulink url="https://copr.fedorainfracloud.org/coprs/elicro/Squid-Cache/"/> </para></section><section><title>Stable Repository Package (like epel-release)</title><para>To install run the command: </para><screen><![CDATA[yum install http://ngtech.co.il/repo/centos/7/squid-repo-1-1.el7.centos.noarch.rpm -y]]></screen><para>or  </para><screen><![CDATA[rpm -i http://ngtech.co.il/repo/centos/7/squid-repo-1-1.el7.centos.noarch.rpm]]></screen><para>and then install squid using the command: </para><screen><![CDATA[yum install squid]]></screen></section><section><title>Squid-4 release</title><itemizedlist><listitem><para><emphasis role="strong">Maintainer:</emphasis> Unofficial packages built by Eliezer Croitoru which can be used on CentOS 7. </para></listitem><listitem><para><emphasis role="strong">Current:</emphasis> 4.1-5 based on the latest release. </para></listitem></itemizedlist><para>The RPMs was separated into three files: </para><itemizedlist><listitem><para>squid-VERSION.rpm </para></listitem><listitem><para>squid-helpers-VERSION.rpm </para></listitem><listitem><para>squid-debuginfo-VERSION.rpm </para></listitem></itemizedlist><para>The core squid rpm will provide the basic squid forward, intercept and tproxy modes while also allowing ssl-bump. The helpers package contains all sorts of other helpers which are bundled with squid sources but are not essential for a basic and simple proxy. </para><itemizedlist><listitem><para>pinger is now disabled by default to allow a smooth startup on selinux enabled system. </para></listitem><listitem><para>src rpm files are at: <ulink url="http://www1.ngtech.co.il/repo/centos/7/beta/SRPMS/"/> </para></listitem><listitem><para>binary RPMs can be found in the architecture specific folders at <ulink url="http://www1.ngtech.co.il/repo/centos/7/beta/x86_64/"/> </para></listitem></itemizedlist><screen><![CDATA[[squid]
name=Squid repo for CentOS Linux - 7 
#IL mirror
baseurl=http://www1.ngtech.co.il/repo/centos/$releasever/beta/$basearch/
failovermethod=priority
enabled=1
gpgcheck=0]]></screen><para>Install Procedure: </para><screen><![CDATA[yum update
yum install squid]]></screen></section><section><title>Squid-3.5</title><itemizedlist><listitem><para><emphasis role="strong">Maintainer:</emphasis> Unofficial packages built by Eliezer Croitoru which can be used on CentOS 6 and 7 </para></listitem><listitem><para><emphasis role="strong">Current:</emphasis> 3.5.25-1 based on the latest release. </para></listitem></itemizedlist><para>The RPMs was separated into three files: </para><itemizedlist><listitem><para>squid-VERSION.rpm </para></listitem><listitem><para>squid-helpers-VERSION.rpm </para></listitem><listitem><para>squid-debuginfo-VERSION.rpm </para></listitem></itemizedlist><para>The core squid rpm will provide the basic squid forward, intercept and tproxy modes while also allowing ssl-bump. The helpers package contains all sorts of other helpers which are bundled with squid sources but are not essential for a basic and simple proxy. </para><itemizedlist><listitem><para>Since 3.5.7-2 I disabled pinger by default to allow a smooth startup on selinux enabled system. </para></listitem><listitem><para>src rpm files are at: <ulink url="http://www1.ngtech.co.il/repo/centos/$releasever/SRPMS/"/> </para></listitem><listitem><para>binary RPMs can be found in the architecture specific folders at <ulink url="http://www1.ngtech.co.il/repo/centos/$releasever/"/> </para></listitem></itemizedlist><screen><![CDATA[[squid]
name=Squid repo for CentOS Linux - $basearch
#IL mirror
baseurl=http://www1.ngtech.co.il/repo/centos/$releasever/$basearch/
failovermethod=priority
enabled=1
gpgcheck=0]]></screen><para>Install Procedure: </para><screen><![CDATA[yum update
yum install squid]]></screen></section><section><title>Squid-3.4</title><itemizedlist><listitem><para><emphasis role="strong">Maintainer:</emphasis> Unofficial packages built by Eliezer Croitoru which can be used on CentOS 6 </para></listitem><listitem><para><emphasis role="strong">Eliezer</emphasis>: As of 3.4.0.2 I am releasing the squid RPMs for two CPU classes OS, i686 and x86_64. </para></listitem><listitem><para>Since somewhere in the 3.4 tree there was a change in the way the squid was packaged by me: </para></listitem></itemizedlist><para>The RPMs was separated into three files: </para><itemizedlist><listitem><para>squid-VERSION.rpm </para></listitem><listitem><para>squid-helpers-VERSION.rpm </para></listitem><listitem><para>squid-debuginfo-VERSION.rpm </para></listitem></itemizedlist><para>The core squid rpm will provides the basic squid forward, intercept and tproxy modes while also allowing ssl-bump. The helpers package contains all sorts of other helpers which are bundled with squid sources but are not essential for a basic and simple proxy. </para><para>There are couple issues that needs to be fixed since there was some data loss in the transition from my old server to another. </para><itemizedlist><listitem><para>The init.d script, I am have been working on it in my spare time. </para></listitem><listitem><para>src rpm files are at: <ulink url="http://www1.ngtech.co.il/repo/centos/6/SRPMS/"/> </para></listitem></itemizedlist><screen><![CDATA[[squid]
name=Squid repo for CentOS Linux 6 - $basearch
#IL mirror
baseurl=http://www1.ngtech.co.il/repo/centos/6/$basearch
failovermethod=priority
enabled=1
gpgcheck=0]]></screen><para>Install Procedure: </para><screen><![CDATA[yum update
yum install squid]]></screen></section><section><title>Squid-3.3</title><itemizedlist><listitem><para>Official package bundled with CentOS 7 </para></listitem></itemizedlist><para>Install Procedure: </para><screen><![CDATA[yum update
yum install squid]]></screen><itemizedlist><listitem><para><emphasis role="strong">Maintainer:</emphasis> Unofficial packages built by Eliezer Croitoru which can be used on CentOS 6 </para></listitem></itemizedlist><screen><![CDATA[[squid]
name=Squid repo for CentOS Linux 6 - $basearch
#IL mirror
baseurl=http://www1.ngtech.co.il/repo/centos/6/$basearch
failovermethod=priority
enabled=1
gpgcheck=0]]></screen><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> <emphasis role="strong">Eliezer:</emphasis> a nice build from a friend that is hosted on SUSE servers. </para></listitem></itemizedlist><para>at: <ulink url="http://software.opensuse.org/download.html?project=home%3Aairties%3Aserver&amp;package=squid3"/> </para><screen><![CDATA[cd /etc/yum.repos.d/
wget http://download.opensuse.org/repositories/home:airties:server/CentOS_CentOS-6/home:airties:server.repo
yum install squid3]]></screen></section><section><title>Squid-3.1</title><itemizedlist><listitem><para>Official package bundled with CentOS 6.6 </para></listitem></itemizedlist><para>Install Procedure: </para><screen><![CDATA[yum update
yum install squid]]></screen></section></section></section><section><title>Potentially missing OS resources (libs\software)</title><para>There are couple dependencies that CentOS might need but cannot be installed by &quot;yum install&quot; yet.. </para><para>One of the dependencies I have seen are: </para><para>&quot;Crypt::X509&quot; which is a perl module that is not in the basic repos of centos. </para><para>In order to install it use cpan or EPEL repositories. </para><screen><![CDATA[# cpan
> install Crypt::X509]]></screen><para><emphasis role="strong">troubleshooting SSL</emphasis>: first install the libs then see what happens. </para></section><section><title>Compiling</title><screen><![CDATA[# You will need the usual build chain
yum install -y perl gcc autoconf automake make sudo wget
]]><![CDATA[
# and some extra packages
yum install libxml2-devel libcap-devel
]]><![CDATA[
# to bootstrap and build from bzr needs also the packages
yum install libtool-ltdl-devel]]></screen><para>The following ./configure options install Squid into the CentOS structure properly:  </para><screen><![CDATA[  --prefix=/usr
  --includedir=/usr/include
  --datadir=/usr/share
  --bindir=/usr/sbin
  --libexecdir=/usr/lib/squid
  --localstatedir=/var
  --sysconfdir=/etc/squid]]></screen></section><section><title>Troubleshooting</title></section><section><title>Repository Mirror Script</title><para>A copy of <ulink url="https://gist.github.com/elico/333bff85f3df2889db7af2795f9d7898"/> </para><programlisting format="linespecific" language="highlight" linenumbering="numbered" startinglinenumber="1"><lineannotation><![CDATA[#!/usr/bin/env bash]]></lineannotation>
<lineannotation></lineannotation>
<lineannotation><![CDATA[#  @author:       Alexandre Plennevaux]]></lineannotation>
<lineannotation></lineannotation><lineannotation><![CDATA[#  @description:  MIRROR DISTANT FOLDER TO LOCAL FOLDER using lftp]]></lineannotation>
<lineannotation></lineannotation><lineannotation><![CDATA[#  @modified:     Eliezer Croitoru to mirror remote HTTP repo]]></lineannotation>
<lineannotation></lineannotation><lineannotation><![CDATA[#  @url:          https://gist.github.com/pixeline/0f9f922cffb5a6bba97a]]></lineannotation>
<lineannotation></lineannotation>
<lineannotation><![CDATA[## LICENSE, 3-Clause BSD.]]></lineannotation>
<lineannotation></lineannotation>
<![CDATA[lockfile -r 0 /tmp/mirror-ngtech-repo.lock || ]]><token><![CDATA[exit]]></token><![CDATA[ 1]]>

<lineannotation><![CDATA[# FTP LOGIN]]></lineannotation>
<lineannotation></lineannotation><methodname><![CDATA[HOST]]></methodname><![CDATA[=]]><phrase><![CDATA['http://ngtech.co.il']]></phrase>
<methodname><![CDATA[PORT]]></methodname><![CDATA[=]]><phrase><![CDATA["80"]]></phrase>

<lineannotation><![CDATA[#USER='ftpusername']]></lineannotation>
<lineannotation></lineannotation><lineannotation><![CDATA[#PASSWORD='ftppassword']]></lineannotation>
<lineannotation></lineannotation>
<lineannotation><![CDATA[# DISTANT DIRECTORY]]></lineannotation>
<lineannotation></lineannotation><methodname><![CDATA[REMOTE_DIR]]></methodname><![CDATA[=]]><phrase><![CDATA['/repo/']]></phrase>

<lineannotation><![CDATA[#LOCAL DIRECTORY]]></lineannotation>
<lineannotation></lineannotation><methodname><![CDATA[LOCAL_DIR]]></methodname><![CDATA[=]]><phrase><![CDATA['/tmp/backups']]></phrase>

<methodname><![CDATA[DOWNLOAD_SPEED]]></methodname><![CDATA[=]]><phrase><![CDATA["1M"]]></phrase>

<lineannotation><![CDATA[# RUNTIME!]]></lineannotation>
<lineannotation></lineannotation><token><![CDATA[echo]]></token>
<token><![CDATA[echo]]></token><![CDATA[ ]]><phrase><![CDATA["]]></phrase><phrase><![CDATA[Starting download ]]></phrase><phrase><![CDATA[${]]></phrase><methodname><![CDATA[REMOTE_DIR]]></methodname><phrase><![CDATA[}]]></phrase><phrase><![CDATA[ from ]]></phrase><phrase><![CDATA[${]]></phrase><methodname><![CDATA[HOST]]></methodname><phrase><![CDATA[}]]></phrase><phrase><![CDATA[ to ]]></phrase><phrase><![CDATA[${]]></phrase><methodname><![CDATA[LOCAL_DIR]]></methodname><phrase><![CDATA[}]]></phrase><phrase><![CDATA["]]></phrase>
<![CDATA[date]]>

<lineannotation><![CDATA[#lftp -u "${USER}","${PASSWORD}" ${HOST} <<EOF]]></lineannotation>
<lineannotation></lineannotation><![CDATA[lftp ]]><phrase><![CDATA[${]]></phrase><methodname><![CDATA[HOST]]></methodname><phrase><![CDATA[}]]></phrase><phrase><![CDATA[${]]></phrase><methodname><![CDATA[REMOTE_DIR]]></methodname><phrase><![CDATA[}]]></phrase><![CDATA[ -p ]]><phrase><![CDATA[${]]></phrase><methodname><![CDATA[PORT]]></methodname><phrase><![CDATA[}]]></phrase><![CDATA[ ]]><phrase><![CDATA[<<EOF]]></phrase>
<phrase></phrase>
<phrase><![CDATA[# the next 3 lines put you in ftpes mode. Uncomment if you are having trouble connecting.]]></phrase>
<phrase><![CDATA[# set ftp:ssl-force true]]></phrase>
<phrase><![CDATA[# set ftp:ssl-protect-data true]]></phrase>
<phrase><![CDATA[# set ssl:verify-certificate no]]></phrase>
<phrase><![CDATA[# transfer starts now...]]></phrase>
<phrase><![CDATA[# mirror --only-newer --use-pget-n=10 ${REMOTE_DIR} ${LOCAL_DIR};]]></phrase>
<phrase></phrase>
<phrase><![CDATA[# set download and upload speed limit.]]></phrase>
<phrase><![CDATA[set net:limit-total-rate ${DOWNLOAD_SPEED}:500K]]></phrase>
<phrase></phrase>
<phrase><![CDATA[# start mirroring the folder.]]></phrase>
<phrase><![CDATA[mirror --only-newer --parallel=10 ${REMOTE_DIR} ${LOCAL_DIR};]]></phrase>
<phrase></phrase>
<phrase><![CDATA[exit]]></phrase>
<phrase><![CDATA[EOF]]></phrase>
<token><![CDATA[echo]]></token>
<token><![CDATA[echo]]></token><![CDATA[ ]]><phrase><![CDATA["Transfer finished"]]></phrase>
<![CDATA[rm -f /tmp/mirror-ngtech-repo.lock]]>
<![CDATA[date]]>
</programlisting></section><section><title>Cern Mirror of NgTech rpository</title><para>Cern labs are mirroring <ulink url="https://wiki.squid-cache.org/KnowledgeBase/CentOS/NgTech#">NgTech</ulink> repository for quite some time to:  </para><itemizedlist><listitem><para><ulink url="http://linuxsoft.cern.ch/mirror/www1.ngtech.co.il/repo/centos/7/"/> </para></listitem></itemizedlist><!--rule (<hr>) is not applicable to DocBook--><para> <ulink url="https://wiki.squid-cache.org/KnowledgeBase/CentOS/CategoryKnowledgeBase#">CategoryKnowledgeBase</ulink> <ulink url="https://wiki.squid-cache.org/KnowledgeBase/CentOS/SquidFaq/BinaryPackages#">SquidFaq/BinaryPackages</ulink> </para></section></article>