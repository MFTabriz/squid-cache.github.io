<?xml version="1.0" encoding="utf-8"?><!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>KnowledgeBase/UnparseableHeader</title><revhistory><revision><revnumber>3</revnumber><date>2011-11-23 00:05:35</date><authorinitials>AmosJeffries</authorinitials><revremark>add to error messages category. some polish on example display</revremark></revision><revision><revnumber>2</revnumber><date>2011-06-27 23:08:09</date><authorinitials>AmosJeffries</authorinitials><revremark>typo</revremark></revision><revision><revnumber>1</revnumber><date>2011-06-27 23:07:38</date><authorinitials>AmosJeffries</authorinitials><revremark>initial writeup</revremark></revision></revhistory></articleinfo><section><title>HTTP header parsing problems</title><para><emphasis role="strong">Symptoms</emphasis> </para><itemizedlist><listitem><para>WARNING: unparseable HTTP header field {...} </para></listitem><listitem><para>WARNING: unparseable HTTP header field {HTTP/1.0 200 OK} <inlinemediaobject><imageobject><imagedata depth="13" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/prio1.png" width="15"/></imageobject><textobject><phrase>{1}</phrase></textobject></inlinemediaobject> </para></listitem></itemizedlist><para><emphasis role="strong">Explanation</emphasis> </para><para>The client or server has sent Squid a header which does not comply with the HTTP protocol standards. HTTP headers are plain text and have the format <emphasis role="strong">Name: values</emphasis>. The quoted value inside {} brackets is what Squid was given. </para><para>Set <ulink url="http://www.squid-cache.org/Doc/config/relaxed_header_parser#">relaxed_header_parser</ulink> to <emphasis role="strong">warn</emphasis> (or <emphasis role="strong">off</emphasis>) for more detailed diagnostics of the problem. </para><para>For example <inlinemediaobject><imageobject><imagedata depth="13" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/prio1.png" width="15"/></imageobject><textobject><phrase>{1}</phrase></textobject></inlinemediaobject> ; </para><itemizedlist><listitem override="none"><para>This broken server (or script) is sending two replies. But it fails to send the reply separator between them. So Squid believe the start of the second reply is just another header in the first: </para></listitem></itemizedlist><screen><![CDATA[2005/04/13 22:44:17| WARNING: unparseable HTTP header field {HTTP/1.0 200 OK}
2005/04/13 22:44:17| in {Server: .
Content-type: text/html
Date: Wed, 13 Apr 2005 20:45:40 GMT
Connection: close
HTTP/1.0 200 OK
Server: .
Content-type: text/html
Connection: close
}]]></screen><para>Example 2; </para><itemizedlist><listitem override="none"><para>This broken software is having the same problem. Although it is mangling the body data into the headers. The garbage you see here is some form of serialized data. </para></listitem></itemizedlist><screen><![CDATA[2005/09/11 23:19:36| WARNING: unparseable HTTP header field {N*!!!PT!!!U_~~~~~~8OQVn8PP>0!!!NB!!!)2~!!!1t!!!7T!!!<^~!#Ds0*E[XF![(N*!!!PT!!!U_~~~~~~8OQVn8PP>0 !!!NB!!!)<~!!!1t!!!7T!!!<^~! ]]></screen><para><emphasis role="strong">Workaround</emphasis> </para><itemizedlist><listitem><para>Fix the software sending this header. if you cant do that yourself report it to the broken server or client software authors please. This used to be a big problem around 2005 but has become less common now that all the middleware proxies dump these requests. The authors need to be informed ASAP about what is happening so they can get their sites or agents working. </para></listitem><listitem><para>NOTE: Bypassing the proxy without informing anyone is not a useful fix. Your client will be facing connection issues which are hard to determine from their end. They will still face the same problem from other software around the Internet. </para></listitem></itemizedlist><!--rule (<hr>) is not applicable to DocBook--><para> <ulink url="https://wiki.squid-cache.org/KnowledgeBase/UnparseableHeader/CategoryKnowledgeBase#">CategoryKnowledgeBase</ulink> <ulink url="https://wiki.squid-cache.org/KnowledgeBase/UnparseableHeader/CategoryErrorMessages#">CategoryErrorMessages</ulink> <ulink url="https://wiki.squid-cache.org/KnowledgeBase/UnparseableHeader/SquidFaq#">SquidFaq</ulink> </para></section></article>