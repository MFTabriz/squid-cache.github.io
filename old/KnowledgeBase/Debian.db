<?xml version="1.0" encoding="utf-8"?><!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>KnowledgeBase/Debian</title><revhistory><revision><revnumber>30</revnumber><date>2018-12-18 03:06:26</date><authorinitials>AmosJeffries</authorinitials><revremark>update for Debian 10 current package status</revremark></revision><revision><revnumber>29</revnumber><date>2018-03-24 18:00:20</date><authorinitials>AmosJeffries</authorinitials><revremark>update and re-publish the custom package building details</revremark></revision><revision><revnumber>28</revnumber><date>2017-11-21 17:38:11</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>27</revnumber><date>2017-11-21 17:34:25</date><authorinitials>AmosJeffries</authorinitials><revremark>Debian Squid-4 package is now available, sort-of</revremark></revision><revision><revnumber>26</revnumber><date>2017-11-11 02:11:36</date><authorinitials>AmosJeffries</authorinitials><revremark>document how to build Squid-4 experiemental packages.</revremark></revision><revision><revnumber>25</revnumber><date>2017-08-05 05:41:41</date><authorinitials>AmosJeffries</authorinitials><revremark>Mention the libssl related issues in latest Debian/Ubuntu stable.</revremark></revision><revision><revnumber>24</revnumber><date>2015-09-09 19:54:44</date><authorinitials>AmosJeffries</authorinitials><revremark>update to latest build instructions. the &quot;squid3&quot; naming and file structures are deprecated now</revremark></revision><revision><revnumber>23</revnumber><date>2015-09-09 19:49:05</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>22</revnumber><date>2015-09-08 12:22:21</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>21</revnumber><date>2015-09-08 01:37:28</date><authorinitials>AmosJeffries</authorinitials><revremark>link to download URL for Debian init script</revremark></revision><revision><revnumber>20</revnumber><date>2015-09-07 06:03:55</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>19</revnumber><date>2015-09-07 05:59:06</date><authorinitials>AmosJeffries</authorinitials><revremark>update to current Debian situation</revremark></revision><revision><revnumber>18</revnumber><date>2015-08-31 07:48:34</date><authorinitials>FrancescoChemolli</authorinitials><revremark>updated as per Bug 4313</revremark></revision><revision><revnumber>17</revnumber><date>2014-10-13 04:36:54</date><authorinitials>AmosJeffries</authorinitials></revision><revision><revnumber>16</revnumber><date>2012-12-02 22:13:24</date><authorinitials>AmosJeffries</authorinitials><revremark>update to remove most 3.0 and earlier special notes. 3.1+ are the supported versions people will be building now.</revremark></revision><revision><revnumber>15</revnumber><date>2011-09-22 00:01:33</date><authorinitials>AmosJeffries</authorinitials><revremark>mention build-dep for easy library dependency install</revremark></revision><revision><revnumber>14</revnumber><date>2011-05-16 23:58:25</date><authorinitials>AmosJeffries</authorinitials><revremark>mark the end of compile options for ubuntu sub-include</revremark></revision><revision><revnumber>13</revnumber><date>2011-05-10 08:12:55</date><authorinitials>AmosJeffries</authorinitials><revremark>link back to FAQ</revremark></revision><revision><revnumber>12</revnumber><date>2011-05-10 07:38:01</date><authorinitials>AmosJeffries</authorinitials><revremark>small tweaks</revremark></revision><revision><revnumber>11</revnumber><date>2011-01-11 23:30:56</date><authorinitials>AmosJeffries</authorinitials><revremark>3.x in debian is the same process. 3.0 on the way out.</revremark></revision><revision><revnumber>10</revnumber><date>2010-09-13 01:01:29</date><authorinitials>AmosJeffries</authorinitials><revremark>add to CategoryDistributionInfo</revremark></revision><revision><revnumber>9</revnumber><date>2010-09-05 08:30:09</date><authorinitials>AmosJeffries</authorinitials><revremark>debian has special packages for troubleshooting.</revremark></revision><revision><revnumber>8</revnumber><date>2010-06-13 11:39:07</date><authorinitials>AmosJeffries</authorinitials><revremark>3.1 packages are out of experimental on Debian now.</revremark></revision><revision><revnumber>7</revnumber><date>2010-03-19 06:20:02</date><authorinitials>AmosJeffries</authorinitials><revremark>mention workaround to the patching</revremark></revision><revision><revnumber>6</revnumber><date>2010-02-26 13:28:37</date><authorinitials>AmosJeffries</authorinitials><revremark>indent again. :( incude require it at 4</revremark></revision><revision><revnumber>5</revnumber><date>2010-02-26 13:26:00</date><authorinitials>AmosJeffries</authorinitials><revremark>indentation of package details.</revremark></revision><revision><revnumber>4</revnumber><date>2010-02-19 01:21:00</date><authorinitials>AmosJeffries</authorinitials><revremark>cleanup the binary packages list a bit.</revremark></revision><revision><revnumber>3</revnumber><date>2009-12-04 12:11:07</date><authorinitials>AmosJeffries</authorinitials><revremark>invert the include direction. this page is authorative for Debian stuff. other wiki pages link it from here.</revremark></revision><revision><revnumber>2</revnumber><date>2009-11-12 11:01:08</date><authorinitials>AmosJeffries</authorinitials><revremark>typo</revremark></revision><revision><revnumber>1</revnumber><date>2009-11-12 10:36:53</date><authorinitials>AmosJeffries</authorinitials><revremark>create. one-stop-shop for info on Debian Squid. nowdays its just package locations and build flags.</revremark></revision></revhistory></articleinfo><section><title>Squid on Debian</title><section><title>Pre-Built Binary Packages</title><para>Packages available for Squid on multiple architectures. </para><para><emphasis role="strong">Maintainer:</emphasis> Luigi Gangitano </para><section><title>Squid-4</title><para>Bug Reports: <ulink url="http://bugs.debian.org/cgi-bin/pkgreport.cgi?pkg=squid"/> </para><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> Debian Buster (10) </para></listitem></itemizedlist><para>Install Procedure: </para><screen><![CDATA[ aptitude install squid]]></screen><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> Debian Stretch (9) </para></listitem></itemizedlist><para>Add this to <emphasis role="strong">/etc/apt/sources.list.d/testing</emphasis> to enable the Debian Buster/testing repository </para><screen><![CDATA[deb http://deb.debian.org/debian testing main]]></screen><para>Install Procedure: </para><screen><![CDATA[ aptitude -t testing install squid]]></screen></section><section><title>Squid-4 custom package</title><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> Debian Stretch or newer required </para></listitem></itemizedlist><para>Add this to <emphasis role="strong">/etc/apt/sources.list.d/testing</emphasis> to enable the Debian Testing repository </para><screen><![CDATA[deb http://deb.debian.org/debian testing main
deb-src http://deb.debian.org/debian testing main]]></screen><para>Install Procedure for the base package and its dependencies: </para><screen><![CDATA[ aptitude -t testing install squid]]></screen><para>The Debian squid team use git to manage these packages creation. If the latest code is not yet in the apt repository you can build your own cutting-edge package as follows: </para><screen><![CDATA[# install build dependencies
sudo apt-get -t testing build-dep squid
sudo apt-get install git git-buildpackage
]]><![CDATA[
# place a hold on future automated upgrades of the squid package
sudo aptitude hold squid
]]><![CDATA[
# fetch the Debian package repository managed by the Debian pkg-squid team
git clone https://salsa.debian.org/squid-team/squid.git pkg-squid
cd pkg-squid && git checkout master]]></screen><para>Edit debian/rules file to add or remove any custom features you need to change. </para><para>Edit the top entry of debian/changelog to a note about your change, and set a local version identifier such as: </para><screen><![CDATA[squid (4.4-1~example1) UNRELEASED; urgency=medium
]]><![CDATA[
 * Added feature X for use by example]]></screen><para>Building the .deb files </para><screen><![CDATA[gbp buildpackage
cd ..]]></screen><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="15" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/alert.png" width="15"/></imageobject><textobject><phrase>/!\</phrase></textobject></inlinemediaobject> the gbp command may fail to sign the packages if you are not a Debian maintainer yourself. That is okay. </para></listitem></itemizedlist><para>Install Procedure: </para><screen><![CDATA[ sudo dpkg -i squid-common_4.*.deb squid_4.*.deb]]></screen><section><title>Squid-3.5</title><para>Bug Reports: <ulink url="http://bugs.debian.org/cgi-bin/pkgreport.cgi?pkg=squid"/> </para><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> Debian Stretch </para></listitem></itemizedlist><para>Install Procedure: </para><screen><![CDATA[ aptitude install squid]]></screen></section><section><title>Squid-3.4 / Squid-3.1</title><para>Bug Reports: <ulink url="http://bugs.debian.org/cgi-bin/pkgreport.cgi?pkg=squid3"/> </para><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> Debian Jesse or older. </para></listitem></itemizedlist><para>Install Procedure: </para><screen><![CDATA[ aptitude install squid3]]></screen></section><section><title>Squid-2.7</title><para>Bug Reports: <ulink url="http://bugs.debian.org/cgi-bin/pkgreport.cgi?pkg=squid"/> </para><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> Debian Jesse or older. </para></listitem></itemizedlist><para>Install Procedure: </para><screen><![CDATA[ aptitude install squid]]></screen></section></section></section><section><title>Compiling</title><para>Many versions of Ubuntu and Debian are routinely build-tested and unit-tested as part of our <ulink url="https://wiki.squid-cache.org/KnowledgeBase/Debian/BuildFarm#">BuildFarm</ulink> and are known to compile OK. </para><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="15" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/alert.png" width="15"/></imageobject><textobject><phrase>/!\</phrase></textobject></inlinemediaobject> The Linux system layout differs markedly from the Squid defaults. The following ./configure options are needed to install Squid into the Debian / Ubuntu standard filesystem locations: </para></listitem></itemizedlist><screen><![CDATA[--prefix=/usr \
--localstatedir=/var \
--libexecdir=${prefix}/lib/squid \
--datadir=${prefix}/share/squid \
--sysconfdir=/etc/squid \
--with-default-user=proxy \
--with-logdir=/var/log/squid \
--with-pidfile=/var/run/squid.pid]]></screen><para>Plus, of course, any custom configuration options you may need. </para><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-error.png" width="16"/></imageobject><textobject><phrase>{X}</phrase></textobject></inlinemediaobject> For Debian Jesse (8), Ubuntu Oneiric (11.10), or older <emphasis role="strong">squid3</emphasis> packages; the above <emphasis>squid</emphasis> labels should have a <emphasis role="strong">3</emphasis> appended. </para></listitem><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-error.png" width="16"/></imageobject><textobject><phrase>{X}</phrase></textobject></inlinemediaobject> Remember these are only defaults. Altering squid.conf you can point the logs at the right path anyway without either the workaround or the patching. </para></listitem></itemizedlist><para>As always, additional libraries may be required to support the features you want to build. The default package dependencies can be installed using: </para><screen><![CDATA[aptitude build-dep squid]]></screen><para>This requires only that your sources.list contain the <emphasis role="strong">deb-src</emphasis> repository to pull the source package information. Features which are not supported by the distribution package will need investigation to discover the dependency package and install it. </para><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> The usual one requested is <emphasis role="strong">libssl-dev</emphasis> for SSL support. </para><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="15" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/alert.png" width="15"/></imageobject><textobject><phrase>/!\</phrase></textobject></inlinemediaobject> However, please note that <ulink url="https://wiki.squid-cache.org/KnowledgeBase/Debian/Squid-3.5#">Squid-3.5</ulink> is not compatible with OpenSSL v1.1+. As of Debian Squeeze, or Ubuntu Zesty the <emphasis role="strong">libssl1.0-dev</emphasis> package must be used instead. This is resolved in the <ulink url="https://wiki.squid-cache.org/KnowledgeBase/Debian/Squid-4#">Squid-4</ulink> packages. </para></listitem></itemizedlist></listitem></itemizedlist><section><title>Init Script</title><para>The init.d script is part of the official Debain/Ubuntu packaging. It does not come with Squid directly. So you will need to download a copy from <ulink url="https://alioth.debian.org/plugins/scmgit/cgi-bin/gitweb.cgi?p=pkg-squid/pkg-squid3.git;a=blob_plain;f=debian/squid.rc"/> to /etc/init.d/squid </para></section></section><section><title>Troubleshooting</title><para>The <emphasis role="strong">squid-dbg</emphasis> (or <emphasis role="strong">squid3-dbg</emphasis>) packages provides debug symbols needed for bug reporting if the bug is crash related. See the <ulink url="https://wiki.squid-cache.org/KnowledgeBase/Debian/SquidFaq/BugReporting#">Bug Reporting FAQ</ulink> for what details to include in a report. </para><para>Install the one matching your main Squid packages name (<emphasis>squid</emphasis> or <emphasis>squid3</emphasis>) </para><screen><![CDATA[ aptitude install squid-dbg
]]><![CDATA[
 aptitude install squid3-dbg]]></screen><!--rule (<hr>) is not applicable to DocBook--><para> <ulink url="https://wiki.squid-cache.org/KnowledgeBase/Debian/CategoryKnowledgeBase#">CategoryKnowledgeBase</ulink> <ulink url="https://wiki.squid-cache.org/KnowledgeBase/Debian/SquidFaq/BinaryPackages#">SquidFaq/BinaryPackages</ulink> </para></section></section></article>