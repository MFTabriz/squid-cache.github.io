<?xml version="1.0" encoding="utf-8"?><!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>KnowledgeBase/UrlTooLarge</title><revhistory><revision><revnumber>1</revnumber><date>2018-09-16 15:36:39</date><authorinitials>AmosJeffries</authorinitials><revremark>import details from bug report and squid-users for this regularly occuring question</revremark></revision></revhistory></articleinfo><section><title>URL Too Large</title><para><emphasis role="strong">Synopsis</emphasis> </para><para>The HTTP client has sent an HTTP request with a URL longer than Squid is willing to handle. The size detected is indicated following the message. </para><para><emphasis role="strong">Symptoms</emphasis> </para><itemizedlist><listitem><para>urlParse: URL too large </para></listitem><listitem><para>AnyP::Uri::parse: URL too large </para></listitem></itemizedlist><para><emphasis role="strong">Explanation</emphasis> </para><para>This message is informational and starting to appear is the result of the limit on request-lines being raised to 64KB. It would previously show up as invalid request or similar error. </para><para>Note that RFC <ulink url="https://tools.ietf.org/rfc/rfc7230#">7230</ulink> specifies that support for HTTP request-line need be only 8000 octets in total length, and any larger sizes are unlikely to be accepted by HTTP software. The Squid limit already exceeds this. So it is a client bug if the client cannot handle issues with these extra long URL lengths. </para><para><emphasis role="strong">Workaround</emphasis> </para><para>The limit being applied is a MAX_URL macro - the size limit placed on stack variables storing URL parts. Squid will at times allocate up to 5*MAX_URL in stack memory and/or copy the URL into buffers not sized by MAX_URL - so increasing this macro is not recommended. </para><para>Work is ongoing to change Squid into more flexible dynamic buffers. As that update progresses the code altered will migrate naturally to a 64KB or 2MB limit, depending on specifics. The bug <ulink url="https://bugs.squid-cache.org/show_bug.cgi?id=4422#">4422</ulink> is being used to track the work progress. Feel free to subscribe for notifications, but please do not comment there unless you intend to help work on the changes. We already know <emphasis role="strong">everybody</emphasis> is affected by this. </para><!--rule (<hr>) is not applicable to DocBook--><para> <ulink url="https://wiki.squid-cache.org/KnowledgeBase/UrlTooLarge/CategoryKnowledgeBase#">CategoryKnowledgeBase</ulink> </para></section></article>