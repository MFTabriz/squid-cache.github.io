<?xml version="1.0" encoding="utf-8"?><!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>KnowledgeBase/FailedToSelectSource</title><revhistory><revision><revnumber>2</revnumber><date>2011-11-22 22:30:10</date><authorinitials>AmosJeffries</authorinitials><revremark>add to ErrorMessages category</revremark></revision><revision><revnumber>1</revnumber><date>2011-05-24 08:01:40</date><authorinitials>AmosJeffries</authorinitials><revremark>import from mailing list descriptions</revremark></revision></revhistory></articleinfo><section><title>Failed to select source for ...</title><para><emphasis role="strong">Synopsis</emphasis> </para><para>Squid fails for some or all requests. Users see an error page. </para><para><emphasis role="strong">Symptoms</emphasis> </para><para>A user will see the error page <emphasis role="strong">ERR_CANNOT_FORWARD</emphasis>: </para><screen><![CDATA[Unable to forward this request at this time.]]></screen><para>Squid Logs: </para><orderedlist numeration="arabic"><listitem><para>Failed to select source for `<ulink url="http://"/>...' </para><itemizedlist><listitem override="none"><para>always_direct = 0 </para></listitem><listitem override="none"><para>never_direct = 1 </para></listitem></itemizedlist></listitem><listitem><para>Failed to select source for `<ulink url="http://"/>...' </para><itemizedlist><listitem override="none"><para>always_direct = -1 </para></listitem><listitem override="none"><para>never_direct = 1 </para></listitem></itemizedlist></listitem><listitem><para>Failed to select source for `<ulink url="http://"/>...' </para><itemizedlist><listitem override="none"><para>always_direct = 0 </para></listitem><listitem override="none"><para>never_direct = -1 </para></listitem></itemizedlist></listitem><listitem><para>Failed to select source for `<ulink url="http://"/>...' </para><itemizedlist><listitem override="none"><para>always_direct = -1 </para></listitem><listitem override="none"><para>never_direct = -1 </para></listitem></itemizedlist></listitem></orderedlist><para><emphasis role="strong">Explanation</emphasis> </para><para>Squid contains several access control lists which determine how and where a request may be fetched from. </para><para>These are (in order of testing): </para><itemizedlist><listitem><para><ulink url="http://www.squid-cache.org/Doc/config/prefer_direct#">prefer_direct</ulink> (on or off) - whether DIRECT connection to the origin is tried first or last. </para></listitem><listitem><para><ulink url="http://www.squid-cache.org/Doc/config/always_direct#">always_direct</ulink> - whether connections to the origin are <emphasis role="strong">required</emphasis> (allow). </para></listitem><listitem><para><ulink url="http://www.squid-cache.org/Doc/config/never_direct#">never_direct</ulink> - whether DIRECT to origin requests are blocked (allow). </para></listitem><listitem><para><ulink url="http://www.squid-cache.org/Doc/config/cache_peer_access#">cache_peer_access</ulink> - whether the request is permitted to go to this peer (allow). </para></listitem></itemizedlist><para>The error message is just stating the fact that your configuration of these options does not allow this request to be sent directly to the origin server (<ulink url="http://www.squid-cache.org/Doc/config/never_direct#">never_direct</ulink> allow), and none of the peers is capable or allowed to forward the request. </para><para>The most likely cause for this error is that you do not allow this cache to make direct connections to origin servers (<ulink url="http://www.squid-cache.org/Doc/config/never_direct#">never_direct</ulink> allow all), and all configured parent caches are currently unreachable. </para><para><emphasis role="strong">Workaround</emphasis> </para><para>If the result is produced by an upstream peer, you will only see the error page and not the log warnings (at level 1). You can workaround that by sending the affected traffic elsewhere. </para><para>If the problem is being logged by your own Squid. You must fix it. </para><!--rule (<hr>) is not applicable to DocBook--><para> <ulink url="https://wiki.squid-cache.org/KnowledgeBase/FailedToSelectSource/CategoryKnowledgeBase#">CategoryKnowledgeBase</ulink> <ulink url="https://wiki.squid-cache.org/KnowledgeBase/FailedToSelectSource/CategoryErrorMessages#">CategoryErrorMessages</ulink> </para></section></article>