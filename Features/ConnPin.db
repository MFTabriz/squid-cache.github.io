<?xml version="1.0" encoding="utf-8"?><!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>Features/ConnPin</title><revhistory><revision><revnumber>15</revnumber><date>2010-01-19 11:15:34</date><authorinitials>AmosJeffries</authorinitials><revremark>typos. sad.</revremark></revision><revision><revnumber>14</revnumber><date>2010-01-19 11:14:54</date><authorinitials>AmosJeffries</authorinitials><revremark>link config docs and clarify what versions this is available in.</revremark></revision><revision><revnumber>13</revnumber><date>2009-01-09 03:51:52</date><authorinitials>AmosJeffries</authorinitials><revremark>document the configuration options for this feature</revremark></revision><revision><revnumber>12</revnumber><date>2008-11-23 01:32:47</date><authorinitials>AmosJeffries</authorinitials><revremark>also in 2.6, update meta details</revremark></revision><revision><revnumber>11</revnumber><date>2008-11-23 01:31:06</date><authorinitials>AmosJeffries</authorinitials><revremark>completed and merged. update meta data</revremark></revision><revision><revnumber>10</revnumber><date>2008-10-10 00:52:59</date><authorinitials>AmosJeffries</authorinitials><revremark>update for FAQ listing.</revremark></revision><revision><revnumber>9</revnumber><date>2008-10-04 12:51:01</date><authorinitials>AmosJeffries</authorinitials><revremark>bump off wishlist</revremark></revision><revision><revnumber>8</revnumber><date>2008-10-04 12:48:53</date><authorinitials>AmosJeffries</authorinitials><revremark>merged.</revremark></revision><revision><revnumber>7</revnumber><date>2008-09-14 22:55:17</date><authorinitials>AlexRousskov</authorinitials><revremark>fixed goal</revremark></revision><revision><revnumber>6</revnumber><date>2008-09-14 04:09:57</date><authorinitials>AmosJeffries</authorinitials><revremark>updated, being worked on NOW.</revremark></revision><revision><revnumber>5</revnumber><date>2008-08-28 01:13:07</date><authorinitials>AmosJeffries</authorinitials><revremark>link to bugzilla discussions</revremark></revision><revision><revnumber>4</revnumber><date>2008-05-18 19:39:01</date><authorinitials>localhost</authorinitials><revremark>converted to 1.6 markup</revremark></revision><revision><revnumber>3</revnumber><date>2008-03-06 04:46:20</date><authorinitials>AmosJeffries</authorinitials><revremark>client Yahoo (Mark Nottingham) has formally requested it as part of their squid requirements.</revremark></revision><revision><revnumber>2</revnumber><date>2007-10-09 04:45:33</date><authorinitials>AlexRousskov</authorinitials><revremark>Separate categories with a pipe symbol</revremark></revision><revision><revnumber>1</revnumber><date>2007-10-09 03:08:31</date><authorinitials>AlexRousskov</authorinitials><revremark>Moving connection pinning to its own Feature page; needed for Squid 3 only</revremark></revision></revhistory></articleinfo><section><title>Feature: Connection Pinning</title><itemizedlist><listitem><para><emphasis role="strong">Goal</emphasis>: Support connection handling required for NTLM authentication passthrough </para></listitem><listitem><para><emphasis role="strong">Status</emphasis>: complete </para></listitem><listitem><para><emphasis role="strong">Version</emphasis>: 2.6+ and 3.1+ </para></listitem><listitem><para><emphasis role="strong">Developer</emphasis>: <ulink url="https://wiki.squid-cache.org/Features/ConnPin/HenrikNordstrom#">HenrikNordstrom</ulink> (2.6), Christos Tsantilas (3.1) </para></listitem><listitem><para><emphasis role="strong">More</emphasis>: draft-jaganathan-kerberos-http-01.txt and Squid-2 implementation; </para></listitem><listitem><para><emphasis role="strong">More</emphasis>: also <ulink url="https://bugs.squid-cache.org/show_bug.cgi?id=1632#">1632</ulink> </para></listitem></itemizedlist><section><title>Details</title><para>Connection Pinning is especially useful for proxied connections to servers using Microsoft Integrated Login (NTLM/Negotiate), it needs: </para><itemizedlist><listitem><para>code to tie a client-side and a server-side socket exclusively when needed </para></listitem><listitem><para>code to activate the tying when a stateful authentication layer is seen </para></listitem><listitem><para>code to mark the objects downloaded over a pinned connection uncacheable </para></listitem><listitem><para>code to add a header advertising this capability to clients </para></listitem></itemizedlist><para>The HTTP protocol extensions used to negotiate this is documented in Internet Draft draft-jaganathan-kerberos-http-01.txt (a copy can be found in doc/rfc/ in the development tree) </para><para>This feature has been implemented for the Squid-2 branch starting with <ulink url="https://wiki.squid-cache.org/Features/ConnPin/Squid-2.6#">Squid-2.6</ulink> by <ulink url="https://wiki.squid-cache.org/Features/ConnPin/HenrikNordstr%C3%B6m#">HenrikNordstr√∂m</ulink> during the <ulink url="https://wiki.squid-cache.org/Features/ConnPin/CodeSprintOct2005#">CodeSprintOct2005</ulink> code sprint in Torino. </para><para>This feature has been implemented for the Squid-3 branch starting with <ulink url="https://wiki.squid-cache.org/Features/ConnPin/Squid-3.1#">Squid-3.1</ulink> by <ulink url="https://wiki.squid-cache.org/Features/ConnPin/ChristosTsantilas#">ChristosTsantilas</ulink> </para><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> NOTE: This feature does not exist in <ulink url="https://wiki.squid-cache.org/Features/ConnPin/Squid-3.0#">Squid-3.0</ulink>. </para></listitem></itemizedlist></section><section><title>Configuration Options</title><para><emphasis>details relevant to <ulink url="https://wiki.squid-cache.org/Features/ConnPin/Squid-3.1#">Squid-3.1</ulink></emphasis> </para><para>This feature is enabled by default in <ulink url="https://wiki.squid-cache.org/Features/ConnPin/Squid-3.1#">Squid-3.1</ulink> and makes use of the <emphasis role="strong">connection-auth</emphasis> option. </para><para>The option can be applied on <ulink url="http://www.squid-cache.org/Doc/config/http_port#">http_port</ulink>, <ulink url="http://www.squid-cache.org/Doc/config/https_port#">https_port</ulink>, and <ulink url="http://www.squid-cache.org/Doc/config/cache_peer#">cache_peer</ulink> lines. It controls connections either IN or OUT of those access points. If either is disabled connection auth cannot be performed. </para><para>When used on a receiving port it can be set to ON or OFF.  Default is ON. </para><screen><![CDATA[http_port ... connection-auth[=on|off]
https_port ... connection-auth[=on|off]]]></screen><para>When used on a <ulink url="http://www.squid-cache.org/Doc/config/cache_peer#">cache_peer</ulink> link it can be set to ON, OFF, or AUTO.  Default is AUTO which attempts to detect the peer capability when needed. </para><screen><![CDATA[cache_peer ... connection-auth[=on|off|auto]]]></screen><!--rule (<hr>) is not applicable to DocBook--><para> <ulink url="https://wiki.squid-cache.org/Features/ConnPin/CategoryFeature#">CategoryFeature</ulink> </para></section></section></article>