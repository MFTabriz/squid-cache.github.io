<?xml version="1.0" encoding="utf-8"?><!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>Features/EDNS</title><revhistory><revision><revnumber>7</revnumber><date>2010-10-28 11:46:50</date><authorinitials>FrancescoChemolli</authorinitials><revremark>Fixed for features-listing</revremark></revision><revision><revnumber>6</revnumber><date>2010-10-28 09:13:41</date><authorinitials>FrancescoChemolli</authorinitials><revremark>added to complete features list</revremark></revision><revision><revnumber>5</revnumber><date>2010-10-17 03:50:19</date><authorinitials>AmosJeffries</authorinitials><revremark>status update.</revremark></revision><revision><revnumber>4</revnumber><date>2010-04-20 05:58:48</date><authorinitials>AmosJeffries</authorinitials><revremark>gave this a hack some time back. its on me list of TODO.</revremark></revision><revision><revnumber>3</revnumber><date>2010-03-26 15:23:18</date><authorinitials>FrancescoChemolli</authorinitials><revremark>templatized.</revremark></revision><revision><revnumber>2</revnumber><date>2009-09-26 06:11:55</date><authorinitials>Henrik Nordström</authorinitials></revision><revision><revnumber>1</revnumber><date>2009-09-25 21:52:22</date><authorinitials>Henrik Nordström</authorinitials></revision></revhistory></articleinfo><section><title>Feature: EDNS support</title><itemizedlist><listitem><para><emphasis role="strong">Goal</emphasis>: For DNS efficiency Squid should include an EDNS OPT record (RFC2671) in it's queries enabling large packets (MTU size) over UDP. </para></listitem><listitem><para><emphasis role="strong">Status</emphasis>: complete </para></listitem><listitem><para><emphasis role="strong">Version</emphasis>: 3.2 </para></listitem><listitem><para><emphasis role="strong">Developer</emphasis>: <ulink url="https://wiki.squid-cache.org/Features/EDNS/AmosJeffries#">AmosJeffries</ulink> </para></listitem><listitem><para><emphasis role="strong">More</emphasis>: <ulink url="https://bugs.squid-cache.org/show_bug.cgi?id=2785#">2785</ulink> </para></listitem></itemizedlist></section><section><title>Details</title><para>When the EDNS option is sent resolvers can send very large replies back over UDP instead of resorting to short lived TCP connections. </para><para>The 512 octets limit is fairly artificial today. Squid has very high limits on how much data the internal DNS resolver can actually receive. So Squid can easily advertise and handle very large packet sizes. </para><section><title>Potential Problems</title><section><title>Resolver support</title><para>Some resolvers have been identified which support EDNS on IPv6 address lookups (AAAA)) but which fail or reject requests with EDNS on IPv4 address lookups (A). </para><itemizedlist><listitem override="none"><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.squid-cache.org/wiki/squidtheme/img/icon-info.png" width="16"/></imageobject><textobject><phrase>{i}</phrase></textobject></inlinemediaobject> To resolve this Squid is currently hard-coded not to send EDNS hints on the IPv4 A lookups. </para></listitem></itemizedlist></section><section><title>Adaptive Jumbograms</title><para>The way EDNS works allows for Squid and its source DNS resolver(s) to automatically achieve the largest necessary packet sizes for communication. </para><para>Due to design issues within Squid we cannot (yet) make use of these hints to automate the packet sizing. Instead the configuration option <ulink url="http://www.squid-cache.org/Doc/config/dns_packet_max#">dns_packet_max</ulink> is needed to set the advertised packet size or disable EDNS entirely. </para><!--rule (<hr>) is not applicable to DocBook--><para> <ulink url="https://wiki.squid-cache.org/Features/EDNS/CategoryFeature#">CategoryFeature</ulink> </para></section></section></section></article>